<html lang="it"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6ImY3NWQ2NDhiMmFkZjUwOWU5MTEzMWVlYjQ2MzRlYTBhNGUxOTg3ZDUiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIxNzk4MzAzODM0Mzk3NTgxOTIzNiIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzNkZjYyOWFhNjU0YzljYzdfdHJhdmVsX3BsYW5uZXJfdmlyZ2luX2l0LTQ4MyJ9LCJleHAiOjE3NTU4NjczNDUsImlhdCI6MTc1NTg2Mzc0NSwiYWxnIjoiUlMyNTYifQ.LTZqS-rgcSYptJEjizhlOsyGylqmmQfud3UHlsrdi0DDA7pBvIsRvaZAq8fkGcEA67Jxk40PuhJLHIwF3pSVxNGfh82hDE7DeLSvFUqAPFS54M5wII2abJKJT4n23-TYMZm7h7G9pr1tLVp_-CIJ_AD2l3jkJxjonexd6-4xoCN1719zPXcQy4z45Bx75al4Gq801Gl32mC513rIbjM0rKyvCATXl4nBJaM69aVnTDp31DiZU-dL4Jfo0pRvsPjWgn7uU2cPd0Vv4982U_sVeUXyedta0z3XzvoHqXHsE_PNzPZFBdv2Dn0ZOLOZq-qJnnj3q7SaXsblm3ChE76fSA","c_3df629aa654c9cc7_travel_planner_virgin_it-483")</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-05-20","imageModelName":"imagen-3.0-generate-002","imageEditModelName":"gemini-2.0-flash-preview-image-generation","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Itinerario di Viaggio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* slate-100 */
        }
        .content-hidden #main-app-container {
            display: none;
        }
        .card {
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); /* shadow-md */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 1.5rem; /* mb-6 */
            transition: all 0.3s ease-in-out;
            border-left-width: 4px;
            background-color: white;
            border-color: transparent;
        }
        .card:hover {
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); /* shadow-lg */
            transform: translateY(-2px);
        }
        h1, h2, h3 {
            font-weight: 700;
        }
        input, textarea, select {
            width: 100%;
            border-radius: 0.5rem; /* rounded-lg */
            border: 1px solid #d1d5db; /* border-gray-300 */
            padding: 0.5rem 0.75rem;
            transition: border-color 0.2s, box-shadow 0.2s;
            background-color: white;
        }
        textarea {
            resize: none;
            overflow: hidden;
        }
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #6366f1; /* indigo-500 */
            box-shadow: 0 0 0 2px #c7d2fe; /* indigo-200 */
        }
        label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.25rem;
            color: #4b5563; /* gray-600 */
        }
        .day-card { border-color: #a5b4fc; }
        .flight-card { background-color: #e0e7ff; border-color: #818cf8; }
        .tour-card { background-color: #dcfce7; border-color: #4ade80; }
        .image-placeholder { min-height: 220px; }
        .tab-button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        .tab-button.active {
            background-color: #4f46e5; /* indigo-600 */
            color: white;
        }
        .tab-button:not(.active) {
            background-color: white;
            color: #4f46e5;
            border-color: #e0e7ff;
        }
        button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        .admin-only, .admin-only-flex, .admin-only-grid { display: none !important; }
        body.admin-mode .admin-only { display: inline-block !important; }
        body.admin-mode .admin-only-flex { display: flex !important; }
        body.admin-mode .admin-only-grid { display: grid !important; }
        body.admin-mode .user-only { display: none !important; }
        .readonly-text {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
            width: 100%;
            white-space: pre-wrap;
            word-break: break-word;
            color: #374151;
            min-height: 38px;
        }
        .day-card-wrapper, .flight-card, .tour-card {
             page-break-inside: avoid;
        }
        .calendar-day {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            height: 50px;
            padding-top: 4px;
        }
        .calendar-day.trip-day {
            background-color: #dcfce7; /* green-100 */
            color: #166534; /* green-800 */
            font-weight: 600;
            cursor: pointer;
            border-radius: 0.5rem;
            transition: all 0.2s ease-in-out;
        }
        .calendar-day.trip-day:hover {
            background-color: #bbf7d0; /* green-200 */
            transform: scale(1.05);
        }
        .calendar-day.today .day-number {
            box-shadow: 0 0 0 2px #6366f1; /* indigo-500 */
            border-radius: 9999px;
            background-color: #e0e7ff;
        }
        .day-number {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .calendar-icons {
            font-size: 0.75rem;
            line-height: 1;
            margin-top: 2px;
        }
        .progress-bar {
            background-color: #e5e7eb; /* gray-200 */
            border-radius: 9999px;
            height: 1.25rem;
            overflow: hidden;
            display: flex;
        }
        .expense-item.on-splid {
            background-color: #f0f9ff; /* sky-50 */
        }
        .expense-item.booked {
            border-left: 4px solid #f59e0b; /* amber-500 */
        }
        .expense-item.paid {
            border-left: 4px solid #22c55e; /* green-500 */
        }

        @media print {
            body { background-color: white; }
            .no-print, .no-print * { display: none !important; }
            .card { box-shadow: none; border: 1px solid #e5e7eb; }
            .day-card-wrapper, .flight-card, .tour-card { page-break-inside: avoid; }
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.right-0{right:0px}.right-2{right:0.5rem}.top-0{top:0px}.top-2{top:0.5rem}.z-10{z-index:10}.z-40{z-index:40}.z-50{z-index:50}.col-span-full{grid-column:1 / -1}.m-0{margin:0px}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:0.25rem;margin-bottom:0.25rem}.mb-10{margin-bottom:2.5rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-1{margin-top:0.25rem}.mt-2{margin-top:0.5rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.mt-8{margin-top:2rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-12{height:3rem}.h-64{height:16rem}.h-4{height:1rem}.h-full{height:100%}.h-5{height:1.25rem}.h-6{height:1.5rem}.w-12{width:3rem}.w-full{width:100%}.w-1{width:0.25rem}.w-32{width:8rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-auto{width:auto}.max-w-3xl{max-width:48rem}.max-w-4xl{max-width:56rem}.max-w-sm{max-width:24rem}.flex-shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.cursor-pointer{cursor:pointer}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-7{grid-template-columns:repeat(7, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-baseline{align-items:baseline}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-4{gap:1rem}.gap-8{gap:2rem}.gap-6{gap:1.5rem}.gap-1{gap:0.25rem}.gap-1\.5{gap:0.375rem}.gap-x-4{column-gap:1rem}.gap-y-1{row-gap:0.25rem}.gap-y-2{row-gap:0.5rem}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.rounded-lg{border-radius:0.5rem}.rounded{border-radius:0.25rem}.rounded-full{border-radius:9999px}.rounded-md{border-radius:0.375rem}.border{border-width:1px}.border-2{border-width:2px}.border-0{border-width:0px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-gray-400{--tw-border-opacity:1;border-color:rgb(156 163 175 / var(--tw-border-opacity, 1))}.border-indigo-300{--tw-border-opacity:1;border-color:rgb(165 180 252 / var(--tw-border-opacity, 1))}.border-slate-300{--tw-border-opacity:1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.border-transparent{border-color:transparent}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.bg-gray-500{--tw-bg-opacity:1;background-color:rgb(107 114 128 / var(--tw-bg-opacity, 1))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.bg-indigo-600{--tw-bg-opacity:1;background-color:rgb(79 70 229 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity:1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.bg-slate-200{--tw-bg-opacity:1;background-color:rgb(226 232 240 / var(--tw-bg-opacity, 1))}.bg-slate-50{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-amber-500{--tw-bg-opacity:1;background-color:rgb(245 158 11 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-green-200{--tw-bg-opacity:1;background-color:rgb(187 247 208 / var(--tw-bg-opacity, 1))}.bg-amber-100{--tw-bg-opacity:1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.bg-amber-200{--tw-bg-opacity:1;background-color:rgb(253 230 138 / var(--tw-bg-opacity, 1))}.bg-opacity-75{--tw-bg-opacity:0.75}.object-cover{object-fit:cover}.p-2{padding:0.5rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-1{padding:0.25rem}.p-0{padding:0px}.p-3{padding:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.pb-2{padding-bottom:0.5rem}.pt-6{padding-top:1.5rem}.pr-10{padding-right:2.5rem}.pl-4{padding-left:1rem}.pr-4{padding-right:1rem}.pb-4{padding-bottom:1rem}.pt-2{padding-top:0.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-2xl{font-size:1.5rem;line-height:2rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.font-bold{font-weight:700}.font-normal{font-weight:400}.font-semibold{font-weight:600}.font-medium{font-weight:500}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity:1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-amber-500{--tw-text-opacity:1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-indigo-700{--tw-text-opacity:1;color:rgb(67 56 202 / var(--tw-text-opacity, 1))}.text-sky-600{--tw-text-opacity:1;color:rgb(2 132 199 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity:1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.text-amber-800{--tw-text-opacity:1;color:rgb(146 64 14 / var(--tw-text-opacity, 1))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-500{transition-duration:500ms}.last\:border-b-0:last-child{border-bottom-width:0px}.hover\:border-indigo-500:hover{--tw-border-opacity:1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-300:hover{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-400:hover{--tw-bg-opacity:1;background-color:rgb(156 163 175 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-50:hover{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-600:hover{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-800:hover{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-900:hover{--tw-bg-opacity:1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-700:hover{--tw-bg-opacity:1;background-color:rgb(67 56 202 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-700:hover{--tw-bg-opacity:1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.hover\:bg-red-600:hover{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.hover\:bg-green-300:hover{--tw-bg-opacity:1;background-color:rgb(134 239 172 / var(--tw-bg-opacity, 1))}.hover\:bg-amber-300:hover{--tw-bg-opacity:1;background-color:rgb(252 211 77 / var(--tw-bg-opacity, 1))}.hover\:text-indigo-600:hover{--tw-text-opacity:1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.hover\:text-red-500:hover{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.hover\:text-indigo-800:hover{--tw-text-opacity:1;color:rgb(55 48 163 / var(--tw-text-opacity, 1))}.hover\:underline:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline}.focus\:border-indigo-500:focus{--tw-border-opacity:1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-0:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-1:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-indigo-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(99 102 241 / var(--tw-ring-opacity, 1))}.focus\:ring-sky-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(14 165 233 / var(--tw-ring-opacity, 1))}.focus\:ring-offset-2:focus{--tw-ring-offset-width:2px}.focus\:ring-offset-0:focus{--tw-ring-offset-width:0px}@media (min-width: 640px){.sm\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.sm\:flex-row{flex-direction:row}.sm\:p-6{padding:1.5rem}}@media (min-width: 768px){.md\:col-span-2{grid-column:span 2 / span 2}.md\:col-start-4{grid-column-start:4}.md\:mb-0{margin-bottom:0px}.md\:w-auto{width:auto}.md\:w-1\/2{width:50%}.md\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:flex-row{flex-direction:row}.md\:items-center{align-items:center}.md\:gap-4{gap:1rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}}@media (min-width: 1024px){.lg\:col-span-2{grid-column:span 2 / span 2}.lg\:col-start-4{grid-column-start:4}.lg\:grid-cols-5{grid-template-columns:repeat(5, minmax(0, 1fr))}.lg\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.lg\:p-8{padding:2rem}}</style><style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.right-0{right:0px}.right-2{right:0.5rem}.top-0{top:0px}.top-2{top:0.5rem}.z-10{z-index:10}.z-40{z-index:40}.z-50{z-index:50}.col-span-full{grid-column:1 / -1}.m-0{margin:0px}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:0.25rem;margin-bottom:0.25rem}.mb-10{margin-bottom:2.5rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-1{margin-top:0.25rem}.mt-2{margin-top:0.5rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.mt-8{margin-top:2rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-12{height:3rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-full{height:100%}.w-1{width:0.25rem}.w-12{width:3rem}.w-32{width:8rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-auto{width:auto}.w-full{width:100%}.max-w-3xl{max-width:48rem}.max-w-4xl{max-width:56rem}.max-w-sm{max-width:24rem}.flex-shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.grid-cols-7{grid-template-columns:repeat(7, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-baseline{align-items:baseline}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-1\.5{gap:0.375rem}.gap-2{gap:0.5rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.gap-x-4{column-gap:1rem}.gap-y-1{row-gap:0.25rem}.gap-y-2{row-gap:0.5rem}.overflow-y-auto{overflow-y:auto}.rounded{border-radius:0.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.border{border-width:1px}.border-0{border-width:0px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-gray-400{--tw-border-opacity:1;border-color:rgb(156 163 175 / var(--tw-border-opacity, 1))}.border-indigo-300{--tw-border-opacity:1;border-color:rgb(165 180 252 / var(--tw-border-opacity, 1))}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-300{--tw-border-opacity:1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.bg-amber-100{--tw-bg-opacity:1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.bg-amber-200{--tw-bg-opacity:1;background-color:rgb(253 230 138 / var(--tw-bg-opacity, 1))}.bg-amber-500{--tw-bg-opacity:1;background-color:rgb(245 158 11 / var(--tw-bg-opacity, 1))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.bg-gray-500{--tw-bg-opacity:1;background-color:rgb(107 114 128 / var(--tw-bg-opacity, 1))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-green-200{--tw-bg-opacity:1;background-color:rgb(187 247 208 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-indigo-600{--tw-bg-opacity:1;background-color:rgb(79 70 229 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity:1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.bg-slate-200{--tw-bg-opacity:1;background-color:rgb(226 232 240 / var(--tw-bg-opacity, 1))}.bg-slate-50{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-opacity-75{--tw-bg-opacity:0.75}.object-cover{object-fit:cover}.p-0{padding:0px}.p-1{padding:0.25rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.pb-2{padding-bottom:0.5rem}.pb-4{padding-bottom:1rem}.pl-4{padding-left:1rem}.pr-10{padding-right:2.5rem}.pr-4{padding-right:1rem}.pt-2{padding-top:0.5rem}.pt-6{padding-top:1.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.text-amber-500{--tw-text-opacity:1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.text-amber-800{--tw-text-opacity:1;color:rgb(146 64 14 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity:1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity:1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-indigo-700{--tw-text-opacity:1;color:rgb(67 56 202 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-sky-600{--tw-text-opacity:1;color:rgb(2 132 199 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-500{transition-duration:500ms}.last\:border-b-0:last-child{border-bottom-width:0px}.hover\:bg-amber-300:hover{--tw-bg-opacity:1;background-color:rgb(252 211 77 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-300:hover{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-400:hover{--tw-bg-opacity:1;background-color:rgb(156 163 175 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-50:hover{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-600:hover{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-800:hover{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-900:hover{--tw-bg-opacity:1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.hover\:bg-green-300:hover{--tw-bg-opacity:1;background-color:rgb(134 239 172 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-700:hover{--tw-bg-opacity:1;background-color:rgb(67 56 202 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-700:hover{--tw-bg-opacity:1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.hover\:bg-red-600:hover{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.hover\:text-indigo-600:hover{--tw-text-opacity:1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.hover\:text-indigo-800:hover{--tw-text-opacity:1;color:rgb(55 48 163 / var(--tw-text-opacity, 1))}.hover\:text-red-500:hover{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.hover\:underline:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline}.focus\:border-indigo-500:focus{--tw-border-opacity:1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-0:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-1:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-indigo-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(99 102 241 / var(--tw-ring-opacity, 1))}.focus\:ring-sky-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(14 165 233 / var(--tw-ring-opacity, 1))}.focus\:ring-offset-0:focus{--tw-ring-offset-width:0px}.focus\:ring-offset-2:focus{--tw-ring-offset-width:2px}@media (min-width: 640px){.sm\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.sm\:flex-row{flex-direction:row}.sm\:p-6{padding:1.5rem}}@media (min-width: 768px){.md\:col-span-2{grid-column:span 2 / span 2}.md\:col-start-4{grid-column-start:4}.md\:mb-0{margin-bottom:0px}.md\:w-1\/2{width:50%}.md\:w-auto{width:auto}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.md\:flex-row{flex-direction:row}.md\:items-center{align-items:center}.md\:gap-4{gap:1rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}}@media (min-width: 1024px){.lg\:col-span-2{grid-column:span 2 / span 2}.lg\:col-start-4{grid-column-start:4}.lg\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.lg\:grid-cols-5{grid-template-columns:repeat(5, minmax(0, 1fr))}.lg\:p-8{padding:2rem}}</style></head>
<body class="content-hidden">

    <!-- Site Access Modal -->
    <div id="site-access-modal" class="fixed inset-0 bg-gray-900 flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-xl text-center w-full max-w-sm mx-4">
            <h2 class="text-2xl font-bold mb-4">Accesso Richiesto</h2>
            <p class="text-gray-600 mb-6">Inserisci la password per visualizzare l'itinerario.</p>
            <form id="site-access-form">
                <input type="password" id="site-access-password-input" class="w-full px-4 py-2 border rounded-lg text-center focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="••••••••">
                <p id="site-access-password-error" class="text-red-500 text-sm mt-2 hidden">Password errata. Riprova.</p>
                <button type="submit" class="w-full mt-4 px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition-colors">Entra</button>
            </form>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="admin-modal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50 no-print hidden">
        <div class="bg-white p-8 rounded-lg shadow-xl text-center w-full max-w-sm mx-4">
            <h2 class="text-2xl font-bold mb-4">Accesso Amministratore</h2>
            <p class="text-gray-600 mb-6">Inserisci la password per modificare l'itinerario.</p>
            <form id="admin-form">
                <input type="password" id="admin-password-input" class="w-full px-4 py-2 border rounded-lg text-center focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="••••••••">
                <p id="admin-password-error" class="text-red-500 text-sm mt-2 hidden">Password errata. Riprova.</p>
                <button type="submit" class="w-full mt-4 px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">Accedi</button>
                <button type="button" id="admin-cancel-btn" class="w-full mt-2 px-6 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 transition-colors">Annulla</button>
            </form>
        </div>
    </div>

    <!-- GitHub Image Modal -->
    <div id="github-modal" class="fixed inset-0 bg-gray-800 bg-opacity-75 z-40 items-center justify-center hidden no-print" style="display: none;">
        <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-4xl mx-4 flex flex-col" style="height: 90vh;">
            <h2 class="text-2xl font-bold mb-4">Seleziona un'immagine da GitHub</h2>
            <div class="flex flex-col sm:flex-row gap-4 mb-4">
                <input type="text" id="github-user" placeholder="Nome utente GitHub" class="flex-grow">
                <input type="text" id="github-repo" placeholder="Nome repository (pubblico)" class="flex-grow">
                <button id="fetch-github-images-btn" class="px-5 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition-colors">Carica Immagini</button>
            </div>
            <div id="github-feedback" class="text-green-600 text-sm mb-2"></div>
            <div id="github-image-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 overflow-y-auto p-2 bg-slate-100 rounded-lg flex-grow"></div>
            <button id="close-github-modal-btn" class="mt-4 w-full px-6 py-2 bg-gray-300 text-gray-800 font-semibold rounded-lg hover:bg-gray-400 transition-colors">Chiudi</button>
        </div>
    </div>
    
    <!-- PDF Quality Modal -->
    <div id="pdf-quality-modal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50 no-print hidden">
        <div class="bg-white p-8 rounded-lg shadow-xl text-center w-full max-w-sm mx-4">
            <h2 class="text-2xl font-bold mb-4">Scegli la qualità del PDF</h2>
            <p class="text-gray-600 mb-6">Una qualità più bassa produce un file più piccolo.</p>
            <div class="flex flex-col gap-4">
                <button data-quality="low" class="pdf-quality-btn w-full px-6 py-3 bg-gray-500 text-white font-semibold rounded-lg shadow-md hover:bg-gray-600 transition-colors">
                    Bassa <span class="block text-xs font-normal">(Veloce, file piccolo)</span>
                </button>
                <button data-quality="medium" class="pdf-quality-btn w-full px-6 py-3 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600 transition-colors">
                    Media <span class="block text-xs font-normal">(Consigliata, buon equilibrio)</span>
                </button>
                <button data-quality="high" class="pdf-quality-btn w-full px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition-colors">
                    Alta <span class="block text-xs font-normal">(Lenta, file grande)</span>
                </button>
            </div>
            <button type="button" id="pdf-quality-cancel-btn" class="w-full mt-6 px-6 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 transition-colors">Annulla</button>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="main-app-container" class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-10 relative">
             <div class="absolute top-0 right-0 no-print">
                <button id="admin-login-btn" class="user-only px-4 py-2 bg-gray-700 text-white text-sm font-semibold rounded-lg shadow-md hover:bg-gray-800 transition-colors">Login Admin</button>
                <button id="admin-logout-btn" class="admin-only px-4 py-2 bg-red-500 text-white text-sm font-semibold rounded-lg shadow-md hover:bg-red-600 transition-colors">Logout</button>
            </div>
            
            <div id="main-title-container" class="mt-8 max-w-3xl mx-auto"><h1 class="text-3xl md:text-4xl font-bold text-gray-800"><input type="text" id="main-title-input" value="Viaggio in Giappone" class="w-full text-center border-0 focus:ring-0 bg-transparent p-0 m-0 font-bold text-3xl md:text-4xl"></h1></div>
             <h2 id="editor-subtitle" class="text-xl text-indigo-600 font-semibold mt-2">
                Editor Itinerario
            </h2>

            <div id="main-image-container" class="mt-6 max-w-4xl mx-auto relative">
                <img id="main-image-preview" class="w-full h-64 object-cover rounded-lg shadow-lg" alt="Immagine di copertina" style="display: block;" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/giappone.jpg">
                <div id="main-image-placeholder" class="w-full h-64 bg-slate-200 rounded-lg flex items-center justify-center border-2 border-dashed border-gray-400" style="display: none;">
                    <div class="text-center text-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l-1.586-1.586a2 2 0 00-2.828 0L6 14m6-6v12"></path></svg>
                        <p class="text-lg font-semibold mb-3">Immagine di copertina</p>
                        <div class="admin-only-flex justify-center gap-4">
                            <label for="main-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50">Carica File</label>
                            <button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900" data-target-id="main">da GitHub</button>
                        </div>
                    </div>
                </div>
                <div id="main-image-controls" class="admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;">
                        <button class="github-open-btn p-2 bg-white text-gray-800 rounded-full shadow-md hover:bg-gray-200" data-target-id="main" title="Cambia immagine"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"></path><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd"></path></svg></button>
                        <button class="remove-image-btn p-2 bg-red-500 text-white rounded-full shadow-md hover:bg-red-600" data-target-id="main" title="Rimuovi immagine"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button></div>
                <input type="file" id="main-image-input" class="hidden" accept="image/*">
            </div>
        </header>
        
        <!-- Controls -->
        <div class="flex flex-wrap justify-center items-center gap-4 mb-8 no-print">
            <button id="pdf-btn" class="px-6 py-2 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600 transition-colors">Salva come PDF</button>
            <button id="export-html-btn" class="admin-only px-6 py-2 bg-purple-600 text-white font-semibold rounded-lg shadow-md hover:bg-purple-700 transition-colors">Esporta HTML</button>
            <button id="reset-btn" class="admin-only px-6 py-2 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-red-600 transition-colors">Reset Itinerario</button>
        </div>

        <!-- Calendario Riepilogativo -->
        <section id="calendar-summary" class="mb-10">
            <h2 class="text-2xl mb-4 border-b pb-2 border-gray-300 font-bold text-gray-700">Calendario del Viaggio</h2>
            
            <div id="date-controls" class="admin-only-flex card bg-slate-50 border-indigo-300 mb-6 flex-col md:flex-row gap-4 items-center">
                <div class="flex-grow w-full">
                    <label for="start-date-input" class="font-semibold text-gray-700">Data Inizio</label>
                    <input type="date" id="start-date-input" class="mt-1">
                </div>
                <div class="flex-grow w-full">
                    <label for="end-date-input" class="font-semibold text-gray-700">Data Fine</label>
                    <input type="date" id="end-date-input" class="mt-1">
                </div>
                <button id="apply-dates-btn" class="w-full md:w-auto px-6 py-2.5 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700">Applica Date</button>
            </div>

            <div id="calendar-container" class="flex flex-wrap justify-center gap-8"><div class="w-full md:w-auto">
                    <h3 class="text-xl font-semibold text-center mb-2 text-indigo-700">novembre 2025</h3>
                    <div class="grid grid-cols-7 gap-1 text-center text-sm">
                        <div class="font-bold text-gray-500">Lun</div><div class="font-bold text-gray-500">Mar</div><div class="font-bold text-gray-500">Mer</div><div class="font-bold text-gray-500">Gio</div><div class="font-bold text-gray-500">Ven</div><div class="font-bold text-gray-500">Sab</div><div class="font-bold text-gray-500">Dom</div>
                    <div></div><div></div><div></div><div></div><div></div><div class="calendar-day"><span class="day-number">1</span></div><div class="calendar-day"><span class="day-number">2</span></div><div class="calendar-day"><span class="day-number">3</span></div><div class="calendar-day"><span class="day-number">4</span></div><div class="calendar-day"><span class="day-number">5</span></div><div class="calendar-day"><span class="day-number">6</span></div><div class="calendar-day"><span class="day-number">7</span></div><div class="calendar-day"><span class="day-number">8</span></div><div class="calendar-day"><span class="day-number">9</span></div><div class="calendar-day"><span class="day-number">10</span></div><div class="calendar-day"><span class="day-number">11</span></div><div class="calendar-day"><span class="day-number">12</span></div><div class="calendar-day"><span class="day-number">13</span></div><div class="calendar-day trip-day" data-date="2025-11-14"><span class="day-number">14</span><div class="calendar-icons">✈️</div></div><div class="calendar-day trip-day" data-date="2025-11-15"><span class="day-number">15</span><div class="calendar-icons">✈️</div></div><div class="calendar-day trip-day" data-date="2025-11-16"><span class="day-number">16</span></div><div class="calendar-day trip-day" data-date="2025-11-17"><span class="day-number">17</span></div><div class="calendar-day trip-day" data-date="2025-11-18"><span class="day-number">18</span></div><div class="calendar-day trip-day" data-date="2025-11-19"><span class="day-number">19</span></div><div class="calendar-day trip-day" data-date="2025-11-20"><span class="day-number">20</span></div><div class="calendar-day trip-day" data-date="2025-11-21"><span class="day-number">21</span></div><div class="calendar-day trip-day" data-date="2025-11-22"><span class="day-number">22</span></div><div class="calendar-day trip-day" data-date="2025-11-23"><span class="day-number">23</span></div><div class="calendar-day trip-day" data-date="2025-11-24"><span class="day-number">24</span></div><div class="calendar-day trip-day" data-date="2025-11-25"><span class="day-number">25</span></div><div class="calendar-day trip-day" data-date="2025-11-26"><span class="day-number">26</span></div><div class="calendar-day trip-day" data-date="2025-11-27"><span class="day-number">27</span></div><div class="calendar-day trip-day" data-date="2025-11-28"><span class="day-number">28</span></div><div class="calendar-day trip-day" data-date="2025-11-29"><span class="day-number">29</span><div class="calendar-icons">✈️</div></div><div class="calendar-day trip-day" data-date="2025-11-30"><span class="day-number">30</span><div class="calendar-icons">✈️</div></div></div></div></div>
        </section>

        <!-- Tabs -->
        <div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8 no-print">
            <button id="tab-btn-itinerary" class="tab-button active">Itinerario</button>
            <button id="tab-btn-flights" class="tab-button">Voli</button>
            <button id="tab-btn-tours" class="tab-button">Tour</button>
            <button id="tab-btn-budget" class="tab-button">Budget</button>
            <button id="tab-btn-links" class="tab-button">Link Utili</button>
        </div>

        <!-- Contenuto delle Schede -->
        <main id="main-content">
            <section id="itinerary-content" class="">
                <div id="itinerary-container"><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-14">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">venerdì 14 novembre 2025 (Giorno 1)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day1-date">Data</label><input type="date" id="day1-date" value="2025-11-14"></div><div><label for="day1-location">Località</label><input type="text" id="day1-location" value="Bologna"></div><div><label for="day1-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day1-accommodation" value="Casa" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Casa" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day1-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day1-activities">Attività</label><textarea id="day1-activities">Partenza dall'aeroporto di Bologna alle 19:35. Arriveremo con almeno 3 ore di anticipo per check-in e controlli.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day1-flight-check" checked="" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day1-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day1-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/casa.png" alt="Anteprima">
                            <div id="day1-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day1-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day1">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day1-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day1-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-15">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">sabato 15 novembre 2025 (Giorno 2)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day2-date">Data</label><input type="date" id="day2-date" value="2025-11-15"></div><div><label for="day2-location">Località</label><input type="text" id="day2-location" value="Tokyo"></div><div><label for="day2-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day2-accommodation" value="Hotel Sunroute Plaza Shinjuku" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Hotel%20Sunroute%20Plaza%20Shinjuku" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day2-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day2-activities">Attività</label><textarea id="day2-activities" style="height: 96px;">Atterreremo all'aeroporto di Tokyo (HND) alle 19:45 ora
locale. Sbrigate le formalità doganali, raggiungeremo I'Hotel Sunroute Plaza Shinjuku in taxi o con il comodo "Limousine Bus". Dopo il check-in, avremo la serata libera per una prima passeggiata e una cena nel vivace quartiere di Shinjuku.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day2-flight-check" checked="" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day2-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day2-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20183810.png" alt="Anteprima">
                            <div id="day2-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day2-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day2">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day2-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day2-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-16">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">domenica 16 novembre 2025 (Giorno 3)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day3-date">Data</label><input type="date" id="day3-date" value="2025-11-16"></div><div><label for="day3-location">Località</label><input type="text" id="day3-location" value="Tokyo"></div><div><label for="day3-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day3-accommodation" value="Hotel Sunroute Plaza Shinjuku" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Hotel%20Sunroute%20Plaza%20Shinjuku" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day3-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day3-activities">Attività</label><textarea id="day3-activities" style="height: 228px;">Dedichiamo la giornata all'esplorazione dei quartieri iconici di Tokyo. Iniziamo con l'ipnotico incrocio di Shibuya e la statua di Hachiko. Proseguiamo per Harajuku, passeggiando lungo la vivace Takeshita Street, cuore della cultura giovanile. Concludiamo la giornata nella quiete del vicino Santuario Meiji Jingu, un'oasi di pace immersa in una foresta.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day3-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day3-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day3-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/tokyo.jpg" alt="Anteprima">
                            <div id="day3-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day3-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day3">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day3-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day3-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-17">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">lunedì 17 novembre 2025 (Giorno 4)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day4-date">Data</label><input type="date" id="day4-date" value="2025-11-17"></div><div><label for="day4-location">Località</label><input type="text" id="day4-location" value="Tokyo"></div><div><label for="day4-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day4-accommodation" value="Hotel Sunroute Plaza Shinjuku" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Hotel%20Sunroute%20Plaza%20Shinjuku" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day4-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day4-activities">Attività</label><textarea id="day4-activities" style="height: 146px;">Esploriamo la parte più tradizionale di Tokyo. La mattina
visitiamo Asakusa, con il suo Tempio Senso-ji e la via dello shopping Nakamise-dori. Successivamente, ci spostiamo al Parco di Ueno, dove potremo visitare musei o lo zoo. Nel pomeriggio, ci immergiamo nella cultura "otaku" di Akihabara, il quartiere dell'elettronica, dei manga e degli anime.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day4-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day4-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day4-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184018.png" alt="Anteprima">
                            <div id="day4-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day4-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day4">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day4-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day4-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-18">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">martedì 18 novembre 2025 (Giorno 5)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day5-date">Data</label><input type="date" id="day5-date" value="2025-11-18"></div><div><label for="day5-location">Località</label><input type="text" id="day5-location" value="Nikko"></div><div><label for="day5-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day5-accommodation" value="Hotel Sunroute Plaza Shinjuku" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Hotel%20Sunroute%20Plaza%20Shinjuku" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day5-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day5-activities">Attività</label><textarea id="day5-activities" style="height: 96px;">Giornata dedicata all'escursione a Nikko, sito UNESCO.
Partiamo presto da Asakusa con i treni Tobu (consigliato il
"Nikko Pass", viaggio di circa 2 ore). Arrivati, un bus locale porterà ai templi. Visitiamo il sontuoso Santuario Toshogu, il Tempio Rinnoji e il Santuario Futarasan. Nel pomeriggio, ammiriamo il ponte Shinkyo prima di riprendere il treno per Tokyo.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day5-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day5-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day5-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184253.png" alt="Anteprima">
                            <div id="day5-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day5-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day5">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day5-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day5-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-19">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">mercoledì 19 novembre 2025 (Giorno 6)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day6-date">Data</label><input type="date" id="day6-date" value="2025-11-19"></div><div><label for="day6-location">Località</label><input type="text" id="day6-location" value="Tokyo"></div><div><label for="day6-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day6-accommodation" value="Hotel Sunroute Plaza Shinjuku" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Hotel%20Sunroute%20Plaza%20Shinjuku" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day6-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day6-activities">Attività</label><textarea id="day6-activities" style="height: 156px;">Iniziamo la giornata con una colazione al Mercato Esterno di Tsukiji. Proseguiamo verso Ginza, il quartiere del lusso, per ammirare le vetrine e le architetture. Nel pomeriggio,
visitiamo i tranquilli Giardini Orientali del Palazzo Imperiale. Concludiamo la giornata sulla Tokyo Skytree (prenotazione consigliata) per una vista mozzafiato al tramonto.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day6-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day6-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day6-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184319.png" alt="Anteprima">
                            <div id="day6-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day6-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day6">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day6-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day6-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-20">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">giovedì 20 novembre 2025 (Giorno 7)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day7-date">Data</label><input type="date" id="day7-date" value="2025-11-20"></div><div><label for="day7-location">Località</label><input type="text" id="day7-location" value="Hakone"></div><div><label for="day7-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day7-accommodation" value="Hotel Sunroute Plaza Shinjuku" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Hotel%20Sunroute%20Plaza%20Shinjuku" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day7-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day7-activities">Attività</label><textarea id="day7-activities" style="height: 120px;">Partenza di buon'ora da Shinjuku per Hakone. Utilizziamo
I'"Hakone Free Pass" per i trasporti. Seguiamo il classico
"Hakone Loop": ammiriamo il lago Ashi in battello, saliamo
sulla funivia Owakudani per vedere le sorgenti sulfuree e,
con un po' di fortuna, godere di una vista spettacolare sul
Monte Fuji. Non ci perdiamo il Santuario di Hakone. Rientro Tokyo in serata.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day7-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day7-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day7-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184409.png" alt="Anteprima">
                            <div id="day7-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day7-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day7">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day7-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day7-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-21">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">venerdì 21 novembre 2025 (Giorno 8)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day8-date">Data</label><input type="date" id="day8-date" value="2025-11-21"></div><div><label for="day8-location">Località</label><input type="text" id="day8-location" value="Tokyo"></div><div><label for="day8-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day8-accommodation" value="Hotel Sunroute Plaza Shinjuku" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Hotel%20Sunroute%20Plaza%20Shinjuku" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day8-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day8-activities">Attività</label><textarea id="day8-activities" style="height: 136px;">Per l'ultimo giorno a Tokyo, visitiamo il Museo Ghibli (biglietti da acquistare online con largo anticipo) o esploriamo l'isola artificiale di Odaiba, raggiungibile con la monorotaia Yurikamome. Qui troveremo architetture futuristiche, il museo digitale teamLab Borderless (da prenotare) e una replica della Statua della Libertà, per un'esperienza diversa dal solito.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day8-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day8-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day8-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184514.png" alt="Anteprima">
                            <div id="day8-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day8-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day8">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day8-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day8-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-22">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">sabato 22 novembre 2025 (Giorno 9)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day9-date">Data</label><input type="date" id="day9-date" value="2025-11-22"></div><div><label for="day9-location">Località</label><input type="text" id="day9-location" value="Kyoto"></div><div><label for="day9-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day9-accommodation" value="Nishiyama Ryokan" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Nishiyama%20Ryokan" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day9-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day9-activities">Attività</label><textarea id="day9-activities" style="height: 96px;">Mattinata dedicata al trasferimento a Kyoto con il treno
Shinkansen (circa 2 ore e mezza). Raggiungiamo il
Nishiyama Ryokan per un'autentica esperienza giapponese. Nel pomeriggio, esploriamo il Nishiki Market, "la cucina di Kyoto". Per la serata, ci immergiamo nell'atmosfera magica di Gion, l'antico quartiere delle geishe.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day9-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day9-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day9-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184636.png" alt="Anteprima">
                            <div id="day9-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day9-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day9">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day9-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day9-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-23">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">domenica 23 novembre 2025 (Giorno 10)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day10-date">Data</label><input type="date" id="day10-date" value="2025-11-23"></div><div><label for="day10-location">Località</label><input type="text" id="day10-location" value="Kyoto"></div><div><label for="day10-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day10-accommodation" value="HIYORI Stay Kyoto Kamogawa" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=HIYORI%20Stay%20Kyoto%20Kamogawa" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day10-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day10-activities">Attività</label><textarea id="day10-activities" style="height: 120px;">Oggi ci trasferiamo all'HIYORI Stay Kyoto Kamogawa.
Dedichiamo poi la giornata alla scoperta della parte orientale di Kyoto. Iniziamo dal Fushimi Inari Shrine con i suoi famosi portali rossi, poi visitiamo il Kiyomizu-dera per la sua vista panoramica. Passeggiamo per le storiche stradine di Higashiyama, Sannenzaka e Ninnenzaka, e concludiamo con una visita al Santuario Yasaka.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day10-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day10-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day10-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184550.png" alt="Anteprima">
                            <div id="day10-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day10-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day10">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day10-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day10-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-24">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">lunedì 24 novembre 2025 (Giorno 11)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day11-date">Data</label><input type="date" id="day11-date" value="2025-11-24"></div><div><label for="day11-location">Località</label><input type="text" id="day11-location" value="Osaka"></div><div><label for="day11-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day11-accommodation" value="HIYORI Stay Kyoto Kamogawa" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=HIYORI%20Stay%20Kyoto%20Kamogawa" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day11-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day11-activities">Attività</label><textarea id="day11-activities" style="height: 96px;">Giornata nella vivace Osaka, raggiungibile in 30 minuti di
treno JR da Kyoto. Visitiamo l'imponente Castello di Osaka, poi esploriamo il quartiere di Shinsaibashi per lo shopping. La serata è a Dotonbori, il cuore pulsante della città, con le sue insegne al neon e l'incredibile street food. Assaggiamo takoyaki e okonomiyaki prima di rientrare a Kyoto.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day11-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day11-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day11-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184727.png" alt="Anteprima">
                            <div id="day11-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day11-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day11">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day11-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day11-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-25">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">martedì 25 novembre 2025 (Giorno 12)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day12-date">Data</label><input type="date" id="day12-date" value="2025-11-25"></div><div><label for="day12-location">Località</label><input type="text" id="day12-location" value="Nara"></div><div><label for="day12-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day12-accommodation" value="HIYORI Stay Kyoto Kamogawa" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=HIYORI%20Stay%20Kyoto%20Kamogawa" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day12-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day12-activities">Attività</label><textarea id="day12-activities" style="height: 126px;">Oggi andiamo a Nara, raggiungibile in 45 minuti di treno JR da Kyoto. L'attrazione principale è il Parco di Nara, dove i cervi girano liberamente. All'interno del parco, visitiamo il Tempio Todai-ji con la sua enorme statua del Buddha e il Santuario Kasuga Taisha, famoso per le migliaia di lanterne. Una gita facile e rilassante, con rientro a Kyoto in serata.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day12-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day12-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day12-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184808.png" alt="Anteprima">
                            <div id="day12-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day12-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day12">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day12-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day12-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-26">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">mercoledì 26 novembre 2025 (Giorno 13)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day13-date">Data</label><input type="date" id="day13-date" value="2025-11-26"></div><div><label for="day13-location">Località</label><input type="text" id="day13-location" value="Himeji"></div><div><label for="day13-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day13-accommodation" value="HIYORI Stay Kyoto Kamogawa" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=HIYORI%20Stay%20Kyoto%20Kamogawa" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day13-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day13-activities">Attività</label><textarea id="day13-activities" style="height: 96px;">L'escursione di oggi ci porta al castello più bello del
Giappone. Prendiamo uno Shinkansen da Kyoto per Himeji
(circa 1 ora). Visitiamo il Castello di Himeji, noto come
"I'Airone Bianco", una magnifica struttura originale del
periodo feudale. Successivamente, esploriamo il vicino
giardino Koko-en prima di rientrare a Kyoto nel tardo
pomeriggio.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day13-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day13-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day13-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184838.png" alt="Anteprima">
                            <div id="day13-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day13-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day13">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day13-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day13-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-27">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">giovedì 27 novembre 2025 (Giorno 14)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day14-date">Data</label><input type="date" id="day14-date" value="2025-11-27"></div><div><label for="day14-location">Località</label><input type="text" id="day14-location" value="Kyoto"></div><div><label for="day14-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day14-accommodation" value="HIYORI Stay Kyoto Kamogawa" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=HIYORI%20Stay%20Kyoto%20Kamogawa" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day14-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day14-activities">Attività</label><textarea id="day14-activities" style="height: 160px;">Dedichiamo l'ultimo giorno a Kyoto alla parte nordoccidentale. Iniziamo dalla suggestiva foresta di bambù di Arashiyama e visitiamo il vicino Tempio Tenryu-ji. Nel pomeriggio, ammiriamo il Kinkaku-ji, il famoso Padiglione d'Oro. Se avanza tempo, una visita al Tempio Ryoan-ji, con il suo enigmatico giardino di rocce, completerà la giornata.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day14-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day14-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day14-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184918.png" alt="Anteprima">
                            <div id="day14-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day14-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day14">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day14-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day14-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-28">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">venerdì 28 novembre 2025 (Giorno 15)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day15-date">Data</label><input type="date" id="day15-date" value="2025-11-28"></div><div><label for="day15-location">Località</label><input type="text" id="day15-location" value="Hiroshima"></div><div><label for="day15-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day15-accommodation" value="HIYORI Stay Kyoto Kamogawa" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=HIYORI%20Stay%20Kyoto%20Kamogawa" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day15-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day15-activities">Attività</label><textarea id="day15-activities" style="height: 120px;">Escursione intensa ma imperdibile. Partiamo molto presto da Kyoto con lo Shinkansen per Hiroshima (1h 40m).
Dedichiamo la mattinata al Parco e al Museo della Pace.
Dopo pranzo, treno e traghetto per l'isola di Miyajima per
ammirare il famoso torii "galleggiante" del Santuario di
Itsukushima. Possiamo anche salire sul Monte Misen per una vista spettacolare. Rientro a Kyoto in tarda serata.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day15-flight-check" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day15-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day15-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20185004.png" alt="Anteprima">
                            <div id="day15-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day15-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day15">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day15-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day15-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-29">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">sabato 29 novembre 2025 (Giorno 16)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day16-date">Data</label><input type="date" id="day16-date" value="2025-11-29"></div><div><label for="day16-location">Località</label><input type="text" id="day16-location" value="Volo per l'Italia"></div><div><label for="day16-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day16-accommodation" value="Volo per l'Italia" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Volo%20per%20l'Italia" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day16-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day16-activities">Attività</label><textarea id="day16-activities" style="height: 168px;">È il nostro ultimo giorno in Giappone. Dopo il check-out,
lasceremo i bagagli in hotel o negli armadietti della stazione di Kyoto per goderci la giornata. La mattinata sarà dedicata allo shopping dell'ultimo minuto nel gigantesco complesso della stazione, esplorando negozi come Isetan e The Cube, o in alternativa, facendo un'ultima visita culturale al vicino Tempio To-ji. Dopo un pranzo rilassato, avremo ancora tempo per qualche acquisto. Intorno alle 18:30, recupereremo i bagagli e prenderemo il treno Haruka Express per l'aeroporto del Kansai (KIX), per arrivare in tempo per il nostro volo delle 22:50.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day16-flight-check" checked="" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day16-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day16-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20185142.png" alt="Anteprima">
                            <div id="day16-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day16-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day16">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day16-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day16-image-input" class="hidden" accept="image/*">
                        </div>
                    </div><div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="2025-11-30">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">domenica 30 novembre 2025 (Giorno 17)</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                <div><label for="day17-date">Data</label><input type="date" id="day17-date" value="2025-11-30"></div><div><label for="day17-location">Località</label><input type="text" id="day17-location" value="Bologna"></div><div><label for="day17-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="day17-accommodation" value="Casa" class="pr-10"><a href="https://www.google.com/maps/search/?api=1&amp;query=Casa" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="day17-accommodation" title="Apri in Google Maps"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg></a></div></div><div class="flex-grow flex flex-col"><label for="day17-activities">Attività</label><textarea id="day17-activities">L'arrivo a Bologna è previsto per le 9:55.</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day17-flight-check" checked="" class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="day17-cruise-check" class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="day17-image-preview" class="object-cover w-full h-full rounded-lg" style="display: block" src="https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/casa.png" alt="Anteprima">
                            <div id="day17-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: none">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="day17-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="day17">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="day17-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: flex;"></div>
                            <input type="file" id="day17-image-input" class="hidden" accept="image/*">
                        </div>
                    </div></div>
            </section>
            <section id="flights-content" class="hidden">
                <div id="flights-container"><div class="card flight-card" data-idprefix="flight_1755869495377">
                        <div class="flex justify-between items-start mb-4">
                             <h3 class="text-xl font-semibold text-indigo-700 flex-grow"><span>✈️ <input type="text" id="flight-flight_1755869495377-title" value="Volo Bologna→Tokyo" class="inline-block w-auto p-1 bg-transparent border-0 border-b focus:ring-0 font-semibold text-xl text-indigo-700"></span></h3>
                            <button data-flight-id="flight_1755869495377" class="delete-flight-btn admin-only text-gray-400 hover:text-red-500 p-1" title="Rimuovi volo"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label for="flight_1755869495377-dep-airport">Aeroporto Partenza</label><input type="text" id="flight_1755869495377-dep-airport" value="Aeroporto di Bologna (BLQ)"></div><div><label for="flight_1755869495377-arr-airport">Aeroporto Arrivo</label><input type="text" id="flight_1755869495377-arr-airport" value="Aeroporto di Tokyo (HND)"></div><div><label for="flight_1755869495377-dep-time">Data/Ora Partenza</label><input type="datetime-local" id="flight_1755869495377-dep-time" value="2025-11-14T19:35"></div><div><label for="flight_1755869495377-arr-time">Data/Ora Arrivo</label><input type="datetime-local" id="flight_1755869495377-arr-time" value="2025-11-15T19:45"></div><div><label for="flight_1755869495377-dep-tz">Fuso Orario Partenza</label><select id="flight_1755869495377-dep-tz"><option value="-12">UTC-12:00</option><option value="-11">UTC-11:00</option><option value="-10">UTC-10:00 (HST)</option><option value="-9">UTC-09:00 (AKT)</option><option value="-8">UTC-08:00 (PST)</option><option value="-7">UTC-07:00 (MST)</option><option value="-6">UTC-06:00 (CST)</option><option value="-5">UTC-05:00 (EST)</option><option value="-4">UTC-04:00 (AST)</option><option value="-3">UTC-03:00 (ART)</option><option value="-2">UTC-02:00</option><option value="-1">UTC-01:00</option><option value="0">UTC+00:00 (GMT)</option><option value="1" selected="">UTC+01:00 (CET)</option><option value="2">UTC+02:00 (EET)</option><option value="3">UTC+03:00 (MSK)</option><option value="4">UTC+04:00</option><option value="5">UTC+05:00 (PKT)</option><option value="5.5">UTC+05:30 (IST)</option><option value="6">UTC+06:00</option><option value="7">UTC+07:00 (WIB)</option><option value="8">UTC+08:00 (HKT/PHT)</option><option value="9">UTC+09:00 (JST)</option><option value="9.5">UTC+09:30 (ACST)</option><option value="10">UTC+10:00 (AEST)</option><option value="11">UTC+11:00</option><option value="12">UTC+12:00 (NZST)</option><option value="13">UTC+13:00</option><option value="14">UTC+14:00</option></select></div><div><label for="flight_1755869495377-arr-tz">Fuso Orario Arrivo</label><select id="flight_1755869495377-arr-tz"><option value="-12">UTC-12:00</option><option value="-11">UTC-11:00</option><option value="-10">UTC-10:00 (HST)</option><option value="-9">UTC-09:00 (AKT)</option><option value="-8">UTC-08:00 (PST)</option><option value="-7">UTC-07:00 (MST)</option><option value="-6">UTC-06:00 (CST)</option><option value="-5">UTC-05:00 (EST)</option><option value="-4">UTC-04:00 (AST)</option><option value="-3">UTC-03:00 (ART)</option><option value="-2">UTC-02:00</option><option value="-1">UTC-01:00</option><option value="0">UTC+00:00 (GMT)</option><option value="1">UTC+01:00 (CET)</option><option value="2">UTC+02:00 (EET)</option><option value="3">UTC+03:00 (MSK)</option><option value="4">UTC+04:00</option><option value="5">UTC+05:00 (PKT)</option><option value="5.5">UTC+05:30 (IST)</option><option value="6">UTC+06:00</option><option value="7">UTC+07:00 (WIB)</option><option value="8">UTC+08:00 (HKT/PHT)</option><option value="9" selected="">UTC+09:00 (JST)</option><option value="9.5">UTC+09:30 (ACST)</option><option value="10">UTC+10:00 (AEST)</option><option value="11">UTC+11:00</option><option value="12">UTC+12:00 (NZST)</option><option value="13">UTC+13:00</option><option value="14">UTC+14:00</option></select></div></div>
                    </div><div class="card flight-card" data-idprefix="flight_1755869498321">
                        <div class="flex justify-between items-start mb-4">
                             <h3 class="text-xl font-semibold text-indigo-700 flex-grow"><span>✈️ <input type="text" id="flight-flight_1755869498321-title" value="Kansai(Osaka)→Bologna" class="inline-block w-auto p-1 bg-transparent border-0 border-b focus:ring-0 font-semibold text-xl text-indigo-700"></span></h3>
                            <button data-flight-id="flight_1755869498321" class="delete-flight-btn admin-only text-gray-400 hover:text-red-500 p-1" title="Rimuovi volo"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label for="flight_1755869498321-dep-airport">Aeroporto Partenza</label><input type="text" id="flight_1755869498321-dep-airport" value="Aeroporto internazionale del Kansai (KIX)"></div><div><label for="flight_1755869498321-arr-airport">Aeroporto Arrivo</label><input type="text" id="flight_1755869498321-arr-airport" value="Aeroporto di Bologna (BLQ)"></div><div><label for="flight_1755869498321-dep-time">Data/Ora Partenza</label><input type="datetime-local" id="flight_1755869498321-dep-time" value="2025-11-29T22:50"></div><div><label for="flight_1755869498321-arr-time">Data/Ora Arrivo</label><input type="datetime-local" id="flight_1755869498321-arr-time" value="2025-11-30T09:55"></div><div><label for="flight_1755869498321-dep-tz">Fuso Orario Partenza</label><select id="flight_1755869498321-dep-tz"><option value="-12">UTC-12:00</option><option value="-11">UTC-11:00</option><option value="-10">UTC-10:00 (HST)</option><option value="-9">UTC-09:00 (AKT)</option><option value="-8">UTC-08:00 (PST)</option><option value="-7">UTC-07:00 (MST)</option><option value="-6">UTC-06:00 (CST)</option><option value="-5">UTC-05:00 (EST)</option><option value="-4">UTC-04:00 (AST)</option><option value="-3">UTC-03:00 (ART)</option><option value="-2">UTC-02:00</option><option value="-1">UTC-01:00</option><option value="0">UTC+00:00 (GMT)</option><option value="1" selected="">UTC+01:00 (CET)</option><option value="2">UTC+02:00 (EET)</option><option value="3">UTC+03:00 (MSK)</option><option value="4">UTC+04:00</option><option value="5">UTC+05:00 (PKT)</option><option value="5.5">UTC+05:30 (IST)</option><option value="6">UTC+06:00</option><option value="7">UTC+07:00 (WIB)</option><option value="8">UTC+08:00 (HKT/PHT)</option><option value="9">UTC+09:00 (JST)</option><option value="9.5">UTC+09:30 (ACST)</option><option value="10">UTC+10:00 (AEST)</option><option value="11">UTC+11:00</option><option value="12">UTC+12:00 (NZST)</option><option value="13">UTC+13:00</option><option value="14">UTC+14:00</option></select></div><div><label for="flight_1755869498321-arr-tz">Fuso Orario Arrivo</label><select id="flight_1755869498321-arr-tz"><option value="-12">UTC-12:00</option><option value="-11">UTC-11:00</option><option value="-10">UTC-10:00 (HST)</option><option value="-9">UTC-09:00 (AKT)</option><option value="-8">UTC-08:00 (PST)</option><option value="-7">UTC-07:00 (MST)</option><option value="-6">UTC-06:00 (CST)</option><option value="-5">UTC-05:00 (EST)</option><option value="-4">UTC-04:00 (AST)</option><option value="-3">UTC-03:00 (ART)</option><option value="-2">UTC-02:00</option><option value="-1">UTC-01:00</option><option value="0">UTC+00:00 (GMT)</option><option value="1" selected="">UTC+01:00 (CET)</option><option value="2">UTC+02:00 (EET)</option><option value="3">UTC+03:00 (MSK)</option><option value="4">UTC+04:00</option><option value="5">UTC+05:00 (PKT)</option><option value="5.5">UTC+05:30 (IST)</option><option value="6">UTC+06:00</option><option value="7">UTC+07:00 (WIB)</option><option value="8">UTC+08:00 (HKT/PHT)</option><option value="9">UTC+09:00 (JST)</option><option value="9.5">UTC+09:30 (ACST)</option><option value="10">UTC+10:00 (AEST)</option><option value="11">UTC+11:00</option><option value="12">UTC+12:00 (NZST)</option><option value="13">UTC+13:00</option><option value="14">UTC+14:00</option></select></div></div>
                    </div><div class="flex justify-center mt-6"><button id="add-flight-btn" class="admin-only px-6 py-2 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 transition-colors">Aggiungi Volo</button></div><div class="card mt-8"><h3 class="text-xl font-semibold text-gray-700 mb-4">Riepilogo Durata Voli</h3><table id="flights-summary-table" class="w-full text-sm"><thead><tr class="border-b-2"><th class="text-left font-semibold pb-2">Volo</th><th class="text-right font-semibold pb-2">Durata</th></tr></thead><tbody><tr class="border-b last:border-b-0"><td class="py-2 pr-4 font-medium">Volo Bologna→Tokyo</td><td class="py-2 pl-4 text-right">Durata: 16h 10m</td></tr><tr class="border-b last:border-b-0"><td class="py-2 pr-4 font-medium">Kansai(Osaka)→Bologna</td><td class="py-2 pl-4 text-right">Durata: 19h 5m</td></tr></tbody></table></div></div>
            </section>
             <section id="tours-content" class="hidden">
                <div id="tours-container"><div class="flex justify-center mt-6"><button id="add-tour-btn" class="admin-only px-6 py-2 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 transition-colors">Aggiungi Tour</button></div></div>
            </section>
            <section id="budget-content" class="hidden">
                <div class="card bg-white border-slate-300">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2 md:mb-0">Riepilogo Budget</h2>
                        <div class="flex items-center gap-2">
                            <label for="total-budget-input" class="text-gray-600 font-semibold">Budget Totale:</label>
                            <span class="user-only text-2xl font-bold text-indigo-600">0,00&nbsp;€</span>
                            <input type="number" id="total-budget-input" value="0" step="1" class="admin-only font-bold text-indigo-600 text-xl p-1 w-32">
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="progress-bar">
                            <div class="bg-green-500 h-full transition-all duration-500" style="width: 0%;" title="Pagato: 2.230,00&nbsp;€"></div>
                            <div class="bg-amber-500 h-full transition-all duration-500" style="width: 0%;" title="Prenotato: 2.714,00&nbsp;€"></div>
                        </div>
                    </div>
                    <div class="flex flex-wrap justify-between text-sm font-semibold gap-x-4 gap-y-1">
                        <div class="text-gray-600">
                            Speso: <span class="font-bold text-green-600">2.230,00&nbsp;€</span> + <span class="font-bold text-amber-500">2.714,00&nbsp;€</span> = <span class="font-bold text-red-500">4.944,00&nbsp;€</span>
                        </div>
                        <div class="text-gray-600">
                            Rimanente: <span class="font-bold text-blue-600">-4.944,00&nbsp;€</span>
                        </div>
                    </div>
                </div>
                
                <div class="card bg-slate-50 border-indigo-300 admin-only-grid">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4 col-span-full">Aggiungi Nuova Spesa</h3>
                    <form id="add-expense-form" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end">
                        <div class="lg:col-span-2"><label for="expense-desc">Descrizione</label><input type="text" id="expense-desc" required=""></div>
                        <div><label for="expense-amount">Importo (€)</label><input type="number" id="expense-amount" step="0.01" required=""></div>
                        <div><label for="expense-category">Categoria</label><select id="expense-category"><option value="flights">✈️ Voli</option><option value="hotels">🏨 Alberghi</option><option value="tours">🗺️ Tour &amp; Attività</option><option value="car_rental">🚗 Noleggio Auto</option><option value="misc">🧾 Varie</option></select></div>
                        <div id="expense-nights-container" class="hidden"><label for="expense-nights">Numero Notti</label><input type="number" id="expense-nights" min="1"></div>
                        <div><label for="expense-person">Pagato da</label><input type="text" id="expense-person" required=""></div>
                        <div><label for="expense-status">Stato</label><select id="expense-status"><option value="paid">Pagata</option><option value="booked">Prenotata</option></select></div>
                        <div class="flex items-center"><label for="expense-splid" class="flex items-center gap-2 cursor-pointer pt-6"><input type="checkbox" id="expense-splid" class="w-5 h-5"><span>Su Splid?</span></label></div>
                        <div class="lg:col-start-4"><button type="submit" class="w-full px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700">Aggiungi</button></div>
                    </form>
                </div>
                <div id="budget-summary-by-person" class="mt-6">
                <div class="card">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">Riepilogo per Persona</h3>
                    
                        <div class="mb-4 pb-4 border-b last:border-b-0">
                            <div class="flex justify-between items-baseline">
                                <h4 class="font-semibold text-lg text-indigo-700">Margherita</h4>
                                <p class="font-bold text-lg">4.944,00&nbsp;€</p>
                            </div>
                            <ul class="text-sm mt-2">
                                
                                    <li class="flex justify-between text-gray-600 py-1">
                                        <span>✈️ Voli</span>
                                        <span>2.230,00&nbsp;€</span>
                                    </li>
                                
                                    <li class="flex justify-between text-gray-600 py-1">
                                        <span>🏨 Alberghi</span>
                                        <span>2.714,00&nbsp;€</span>
                                    </li>
                                
                            </ul>
                        </div>
                    
                </div></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                    <div class="card">
                        <h4 class="text-lg font-semibold mb-2">✈️ Voli</h4>
                        <p class="text-gray-600 mb-2 font-bold text-xl">2.230,00&nbsp;€</p>
                        
                        <ul class="text-sm">
                    <li class="expense-item on-splid paid p-3 my-1 rounded-md">
                        <div class="flex justify-between items-start">
                            <div class="flex-grow pr-4">
                                <p>Volo andata Bologna Tokyo ritorno Osaka Bologna (2 persone)</p>
                                <p class="text-xs text-gray-500">Margherita</p>
                                
                            </div>
                            <div class="text-right flex-shrink-0">
                                <p class="font-semibold">2.230,00&nbsp;€</p>
                            </div>
                        </div>
                        <div class="admin-only-flex justify-between items-center mt-2 pt-2 border-t border-slate-200">
                            <div class="flex items-center gap-4">
                                <button data-expense-id="1755869919255" class="status-toggle px-2 py-1 text-xs rounded font-semibold transition-colors bg-green-200 text-green-800 hover:bg-green-300">Pagato</button>
                                <label class="flex items-center gap-1.5 cursor-pointer text-xs text-gray-600">
                                    <input type="checkbox" data-expense-id="1755869919255" class="splid-toggle w-4 h-4 rounded text-indigo-600 focus:ring-indigo-500 focus:ring-offset-0 focus:ring-1" checked="">
                                    Su Splid
                                </label>
                            </div>
                            <button data-expense-id="1755869919255" class="delete-expense-btn text-gray-400 hover:text-red-500" title="Elimina spesa"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                        </div>
                        <div class="user-only flex justify-start items-center gap-2 mt-2 pt-2 border-t border-slate-200 text-xs">
                            <span class="font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-800">Pagato</span>
                            <span class="font-semibold px-2 py-0.5 rounded-full bg-slate-200 text-slate-800">Su Splid</span>
                        </div>
                    </li></ul>
                    </div><div class="card">
                        <h4 class="text-lg font-semibold mb-2">🏨 Alberghi</h4>
                        <p class="text-gray-600 mb-2 font-bold text-xl">2.714,00&nbsp;€</p>
                        <p class="text-sm text-gray-500 mb-4">Totale 14 notti • Media 193,86&nbsp;€/notte</p>
                        <ul class="text-sm">
                    <li class="expense-item  booked p-3 my-1 rounded-md">
                        <div class="flex justify-between items-start">
                            <div class="flex-grow pr-4">
                                <p>Hotel a Tokyo</p>
                                <p class="text-xs text-gray-500">Margherita</p>
                                <p class="text-xs text-gray-500 mt-1">7 notti • 174,86&nbsp;€/notte</p>
                            </div>
                            <div class="text-right flex-shrink-0">
                                <p class="font-semibold">1.224,00&nbsp;€</p>
                            </div>
                        </div>
                        <div class="admin-only-flex justify-between items-center mt-2 pt-2 border-t border-slate-200">
                            <div class="flex items-center gap-4">
                                <button data-expense-id="1755870266762" class="status-toggle px-2 py-1 text-xs rounded font-semibold transition-colors bg-amber-200 text-amber-800 hover:bg-amber-300">Prenotato</button>
                                <label class="flex items-center gap-1.5 cursor-pointer text-xs text-gray-600">
                                    <input type="checkbox" data-expense-id="1755870266762" class="splid-toggle w-4 h-4 rounded text-indigo-600 focus:ring-indigo-500 focus:ring-offset-0 focus:ring-1">
                                    Su Splid
                                </label>
                            </div>
                            <button data-expense-id="1755870266762" class="delete-expense-btn text-gray-400 hover:text-red-500" title="Elimina spesa"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                        </div>
                        <div class="user-only flex justify-start items-center gap-2 mt-2 pt-2 border-t border-slate-200 text-xs">
                            <span class="font-semibold px-2 py-0.5 rounded-full bg-amber-100 text-amber-800">Prenotato</span>
                            
                        </div>
                    </li>
                    <li class="expense-item  booked p-3 my-1 rounded-md">
                        <div class="flex justify-between items-start">
                            <div class="flex-grow pr-4">
                                <p>Ryokan a Kyoto</p>
                                <p class="text-xs text-gray-500">Margherita</p>
                                <p class="text-xs text-gray-500 mt-1">1 notti • 394,00&nbsp;€/notte</p>
                            </div>
                            <div class="text-right flex-shrink-0">
                                <p class="font-semibold">394,00&nbsp;€</p>
                            </div>
                        </div>
                        <div class="admin-only-flex justify-between items-center mt-2 pt-2 border-t border-slate-200">
                            <div class="flex items-center gap-4">
                                <button data-expense-id="1755870303651" class="status-toggle px-2 py-1 text-xs rounded font-semibold transition-colors bg-amber-200 text-amber-800 hover:bg-amber-300">Prenotato</button>
                                <label class="flex items-center gap-1.5 cursor-pointer text-xs text-gray-600">
                                    <input type="checkbox" data-expense-id="1755870303651" class="splid-toggle w-4 h-4 rounded text-indigo-600 focus:ring-indigo-500 focus:ring-offset-0 focus:ring-1">
                                    Su Splid
                                </label>
                            </div>
                            <button data-expense-id="1755870303651" class="delete-expense-btn text-gray-400 hover:text-red-500" title="Elimina spesa"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                        </div>
                        <div class="user-only flex justify-start items-center gap-2 mt-2 pt-2 border-t border-slate-200 text-xs">
                            <span class="font-semibold px-2 py-0.5 rounded-full bg-amber-100 text-amber-800">Prenotato</span>
                            
                        </div>
                    </li>
                    <li class="expense-item  booked p-3 my-1 rounded-md">
                        <div class="flex justify-between items-start">
                            <div class="flex-grow pr-4">
                                <p>Hotel a Kyoto</p>
                                <p class="text-xs text-gray-500">Margherita</p>
                                <p class="text-xs text-gray-500 mt-1">6 notti • 182,67&nbsp;€/notte</p>
                            </div>
                            <div class="text-right flex-shrink-0">
                                <p class="font-semibold">1.096,00&nbsp;€</p>
                            </div>
                        </div>
                        <div class="admin-only-flex justify-between items-center mt-2 pt-2 border-t border-slate-200">
                            <div class="flex items-center gap-4">
                                <button data-expense-id="1755870338956" class="status-toggle px-2 py-1 text-xs rounded font-semibold transition-colors bg-amber-200 text-amber-800 hover:bg-amber-300">Prenotato</button>
                                <label class="flex items-center gap-1.5 cursor-pointer text-xs text-gray-600">
                                    <input type="checkbox" data-expense-id="1755870338956" class="splid-toggle w-4 h-4 rounded text-indigo-600 focus:ring-indigo-500 focus:ring-offset-0 focus:ring-1">
                                    Su Splid
                                </label>
                            </div>
                            <button data-expense-id="1755870338956" class="delete-expense-btn text-gray-400 hover:text-red-500" title="Elimina spesa"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                        </div>
                        <div class="user-only flex justify-start items-center gap-2 mt-2 pt-2 border-t border-slate-200 text-xs">
                            <span class="font-semibold px-2 py-0.5 rounded-full bg-amber-100 text-amber-800">Prenotato</span>
                            
                        </div>
                    </li></ul>
                    </div>
                </div>
                <div id="budget-legend" class="card text-sm mt-6"><h4 class="font-semibold mb-2">Legenda</h4><div class="flex flex-wrap gap-x-4 gap-y-2"><div class="flex items-center gap-2"><div class="w-4 h-4 rounded" style="background-color: #f0f9ff; border: 1px solid #bae6fd;"></div><span>Spesa inserita su Splid</span></div><div class="flex items-center gap-2"><div class="w-1 h-4 bg-green-500 rounded"></div><span>Spesa Pagata</span></div><div class="flex items-center gap-2"><div class="w-1 h-4 bg-amber-500 rounded"></div><span>Spesa solo Prenotata</span></div></div></div></section>
            <section id="links-content" class="hidden"><div class="card bg-white border-slate-300">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Link Utili</h2>
                    <div class="card bg-slate-50 border-indigo-300 mb-6 admin-only-grid"><h3 class="text-xl font-semibold text-gray-700 mb-4">Aggiungi Nuovo Link</h3><form id="add-link-form" class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end"><div class="md:col-span-2"><label for="link-title">Titolo</label><input type="text" id="link-title" required=""></div><div class="md:col-span-2"><label for="link-url">URL</label><input type="url" id="link-url" required=""></div><div class="md:col-start-4"><button type="submit" class="w-full px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700">Aggiungi Link</button></div></form></div>
                    <ul id="useful-links-list">
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.japan-guide.com/" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Japan Guide - Guida Completa</a><p class="text-sm text-gray-500">https://www.japan-guide.com/</p></div>
                    <button data-link-id="1755870422159" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.japan.travel/it/it/" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Ente Nazionale del Turismo Giapponese (JNTO)</a><p class="text-sm text-gray-500">https://www.japan.travel/it/it/</p></div>
                    <button data-link-id="1755870439896" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.tokyometro.jp/en/index.html" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Tokyo Metro (Mappa e Biglietti)</a><p class="text-sm text-gray-500">https://www.tokyometro.jp/en/index.html</p></div>
                    <button data-link-id="1755870471329" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.tokyo-skytree.jp/en/ticket/" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Biglietti Tokyo Skytree</a><p class="text-sm text-gray-500">https://www.tokyo-skytree.jp/en/ticket/</p></div>
                    <button data-link-id="1755870478585" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.ghibli-museum.jp/en/tickets/" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Biglietti Museo Ghibli (Richiede prenotazione)</a><p class="text-sm text-gray-500">https://www.ghibli-museum.jp/en/tickets/</p></div>
                    <button data-link-id="1755870498866" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.teamlab.art/e/borderless-tokyo/" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Biglietti teamLab Borderless</a><p class="text-sm text-gray-500">https://www.teamlab.art/e/borderless-tokyo/</p></div>
                    <button data-link-id="1755870513194" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.city.kyoto.lg.jp/kotsu/page/0000028378.html" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Trasporti a Kyoto (Bus &amp; Metro)</a><p class="text-sm text-gray-500">https://www.city.kyoto.lg.jp/kotsu/page/0000028378.html</p></div>
                    <button data-link-id="1755870538803" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.osp.osaka-info.jp/en/" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Osaka Amazing Pass</a><p class="text-sm text-gray-500">https://www.osp.osaka-info.jp/en/</p></div>
                    <button data-link-id="1755870547123" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.kintetsu.co.jp/foreign/english/sightseeing/nara.html" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Accesso a Nara (Kintetsu Railway)</a><p class="text-sm text-gray-500">https://www.kintetsu.co.jp/foreign/english/sightseeing/nara.html</p></div>
                    <button data-link-id="1755870561764" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.city.himeji.lg.jp/castle/index.html" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Castello di Himeji (Sito Ufficiale)</a><p class="text-sm text-gray-500">https://www.city.himeji.lg.jp/castle/index.html</p></div>
                    <button data-link-id="1755870577548" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://hpmmuseum.jp/modules/info/index.php?action=PageView&amp;page_id=51" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Museo della Pace di Hiroshima</a><p class="text-sm text-gray-500">https://hpmmuseum.jp/modules/info/index.php?action=PageView&amp;page_id=51</p></div>
                    <button data-link-id="1755870591060" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.jr-miyajimaferry.co.jp/en/" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Traghetto per Miyajima (JR Ferry)</a><p class="text-sm text-gray-500">https://www.jr-miyajimaferry.co.jp/en/</p></div>
                    <button data-link-id="1755870605373" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.japan-guide.com/e/e2359_003.html" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Informazioni Suica &amp; Pasmo (IC Cards)</a><p class="text-sm text-gray-500">https://www.japan-guide.com/e/e2359_003.html</p></div>
                    <button data-link-id="1755870620958" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.tobu.co.jp/en/ticket/nikko/" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Nikko Pass (Tobu Railway)</a><p class="text-sm text-gray-500">https://www.tobu.co.jp/en/ticket/nikko/</p></div>
                    <button data-link-id="1755870637166" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li>
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="https://www.odakyu.jp/english/passes/hakone/" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">Hakone Free Pass (Odakyu Railway)</a><p class="text-sm text-gray-500">https://www.odakyu.jp/english/passes/hakone/</p></div>
                    <button data-link-id="1755870651846" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button>
                </li></ul>
                </div></section>
        </main>
    </div>

    <script>
        // --- CONFIGURATION ---
        const SITE_ACCESS_PASSWORD = 'Filippine2026';
        const ADMIN_PASSWORD = 'Kerrickleo';
        const PDF_QUALITY_PRESETS = {
            low:    { scale: 1.5, jpegQuality: 0.6, text: 'Bassa' },
            medium: { scale: 2,   jpegQuality: 0.7, text: 'Media' },
            high:   { scale: 3,   jpegQuality: 0.8, text: 'Alta' }
        };
        const BUDGET_CATEGORIES = {
            'flights': '✈️ Voli',
            'hotels': '🏨 Alberghi',
            'tours': '🗺️ Tour & Attività',
            'car_rental': '🚗 Noleggio Auto',
            'misc': '🧾 Varie'
        };
        const TOUR_TYPES = {
            'boat': '🚢 Escursione in barca',
            'trekking': '⛰️ Trekking',
            'cultural': '🏛️ Tour culturale'
        };
        const TIMEZONES = [
            { name: "UTC-12:00", offset: -12 }, { name: "UTC-11:00", offset: -11 },
            { name: "UTC-10:00 (HST)", offset: -10 }, { name: "UTC-09:00 (AKT)", offset: -9 },
            { name: "UTC-08:00 (PST)", offset: -8 }, { name: "UTC-07:00 (MST)", offset: -7 },
            { name: "UTC-06:00 (CST)", offset: -6 }, { name: "UTC-05:00 (EST)", offset: -5 },
            { name: "UTC-04:00 (AST)", offset: -4 }, { name: "UTC-03:00 (ART)", offset: -3 },
            { name: "UTC-02:00", offset: -2 }, { name: "UTC-01:00", offset: -1 },
            { name: "UTC+00:00 (GMT)", offset: 0 }, { name: "UTC+01:00 (CET)", offset: 1 },
            { name: "UTC+02:00 (EET)", offset: 2 }, { name: "UTC+03:00 (MSK)", offset: 3 },
            { name: "UTC+04:00", offset: 4 }, { name: "UTC+05:00 (PKT)", offset: 5 },
            { name: "UTC+05:30 (IST)", offset: 5.5 }, { name: "UTC+06:00", offset: 6 },
            { name: "UTC+07:00 (WIB)", offset: 7 }, { name: "UTC+08:00 (HKT/PHT)", offset: 8 },
            { name: "UTC+09:00 (JST)", offset: 9 }, { name: "UTC+09:30 (ACST)", offset: 9.5 },
            { name: "UTC+10:00 (AEST)", offset: 10 }, { name: "UTC+11:00", offset: 11 },
            { name: "UTC+12:00 (NZST)", offset: 12 }, { name: "UTC+13:00", offset: 13 },
            { name: "UTC+14:00", offset: 14 }
        ];

        // --- SVG ICONS ---
        const TRASH_ICON_SVG = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>`;
        const PENCIL_ICON_SVG = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>`;

        // --- GLOBAL VARIABLES ---
        let isAdminMode = false;
        let currentData = null;
        const DATA_STORAGE_KEY = 'travelPlannerData_Virgin';

        // --- DEFAULT DATA ---
        const defaultFullData = {
  "main": {
    "title": "Viaggio in Giappone",
    "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/giappone.jpg"
  },
  "flights": [
    {
      "idPrefix": "flight_1755869495377",
      "title": "Volo Bologna→Tokyo",
      "depAirport": "Aeroporto di Bologna (BLQ)",
      "arrAirport": "Aeroporto di Tokyo (HND)",
      "depTime": "2025-11-14T19:35",
      "arrTime": "2025-11-15T19:45",
      "depTz": 1,
      "arrTz": 9
    },
    {
      "idPrefix": "flight_1755869498321",
      "title": "Kansai(Osaka)→Bologna",
      "depAirport": "Aeroporto internazionale del Kansai (KIX)",
      "arrAirport": "Aeroporto di Bologna (BLQ)",
      "depTime": "2025-11-29T22:50",
      "arrTime": "2025-11-30T09:55",
      "depTz": 9,
      "arrTz": 1
    }
  ],
  "itinerary": [
    {
      "date": "2025-11-14",
      "location": "Bologna",
      "isFlight": true,
      "isCruise": false,
      "accommodation": "Casa",
      "activities": "Partenza dall'aeroporto di Bologna alle 19:35. Arriveremo con almeno 3 ore di anticipo per check-in e controlli.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/casa.png"
    },
    {
      "date": "2025-11-15",
      "location": "Tokyo",
      "isFlight": true,
      "isCruise": false,
      "accommodation": "Hotel Sunroute Plaza Shinjuku",
      "activities": "Atterreremo all'aeroporto di Tokyo (HND) alle 19:45 ora locale. Sbrigate le formalità doganali, raggiungeremo I'Hotel Sunroute Plaza Shinjuku in taxi o con il comodo \"Limousine Bus\". Dopo il check-in, avremo la serata libera per una prima passeggiata e una cena nel vivace quartiere di Shinjuku.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20183810.png"
    },
    {
      "date": "2025-11-16",
      "location": "Tokyo",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "Hotel Sunroute Plaza Shinjuku",
      "activities": "Dedichiamo la giornata all'esplorazione dei quartieri iconici di Tokyo. Iniziamo con l'ipnotico incrocio di Shibuya e la statua di Hachiko. Proseguiamo per Harajuku, passeggiando lungo la vivace Takeshita Street, cuore della cultura giovanile. Concludiamo la giornata nella quiete del vicino Santuario Meiji Jingu, un'oasi di pace immersa in una foresta.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/tokyo.jpg"
    },
    {
      "date": "2025-11-17",
      "location": "Tokyo",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "Hotel Sunroute Plaza Shinjuku",
      "activities": "Esploriamo la parte più tradizionale di Tokyo. La mattina visitiamo Asakusa, con il suo Tempio Senso-ji e la via dello shopping Nakamise-dori. Successivamente, ci spostiamo al Parco di Ueno, dove potremo visitare musei o lo zoo. Nel pomeriggio, ci immergiamo nella cultura \"otaku\" di Akihabara, il quartiere dell'elettronica, dei manga e degli anime.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184018.png"
    },
    {
      "date": "2025-11-18",
      "location": "Nikko",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "Hotel Sunroute Plaza Shinjuku",
      "activities": "Giornata dedicata all'escursione a Nikko, sito UNESCO. Partiamo presto da Asakusa con i treni Tobu (consigliato il \"Nikko Pass\", viaggio di circa 2 ore). Arrivati, un bus locale porterà ai templi. Visitiamo il sontuoso Santuario Toshogu, il Tempio Rinnoji e il Santuario Futarasan. Nel pomeriggio, ammiriamo il ponte Shinkyo prima di riprendere il treno per Tokyo.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184253.png"
    },
    {
      "date": "2025-11-19",
      "location": "Tokyo",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "Hotel Sunroute Plaza Shinjuku",
      "activities": "Iniziamo la giornata con una colazione al Mercato Esterno di Tsukiji. Proseguiamo verso Ginza, il quartiere del lusso, per ammirare le vetrine e le architetture. Nel pomeriggio,\nvisitiamo i tranquilli Giardini Orientali del Palazzo Imperiale. Concludiamo la giornata sulla Tokyo Skytree (prenotazione consigliata) per una vista mozzafiato al tramonto.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184319.png"
    },
    {
      "date": "2025-11-20",
      "location": "Hakone",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "Hotel Sunroute Plaza Shinjuku",
      "activities": "Partenza di buon'ora da Shinjuku per Hakone. Utilizziamo I'\"Hakone Free Pass\" per i trasporti. Seguiamo il classico \"Hakone Loop\": ammiriamo il lago Ashi in battello, saliamo\nsulla funivia Owakudani per vedere le sorgenti sulfuree e, con un po' di fortuna, godere di una vista spettacolare sul Monte Fuji. Non ci perdiamo il Santuario di Hakone. Rientro Tokyo in serata.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184409.png"
    },
    {
      "date": "2025-11-21",
      "location": "Tokyo",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "Hotel Sunroute Plaza Shinjuku",
      "activities": "Per l'ultimo giorno a Tokyo, visitiamo il Museo Ghibli (biglietti da acquistare online con largo anticipo) o esploriamo l'isola artificiale di Odaiba, raggiungibile con la monorotaia Yurikamome. Qui troveremo architetture futuristiche, il museo digitale teamLab Borderless (da prenotare) e una replica della Statua della Libertà, per un'esperienza diversa dal solito.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184514.png"
    },
    {
      "date": "2025-11-22",
      "location": "Kyoto",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "Nishiyama Ryokan",
      "activities": "Mattinata dedicata al trasferimento a Kyoto con il treno Shinkansen (circa 2 ore e mezza). Raggiungiamo il Nishiyama Ryokan per un'autentica esperienza giapponese. Nel pomeriggio, esploriamo il Nishiki Market, \"la cucina di Kyoto\". Per la serata, ci immergiamo nell'atmosfera magica di Gion, l'antico quartiere delle geishe.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184636.png"
    },
    {
      "date": "2025-11-23",
      "location": "Kyoto",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "HIYORI Stay Kyoto Kamogawa",
      "activities": "Oggi ci trasferiamo all'HIYORI Stay Kyoto Kamogawa. Dedichiamo poi la giornata alla scoperta della parte orientale di Kyoto. Iniziamo dal Fushimi Inari Shrine con i suoi famosi portali rossi, poi visitiamo il Kiyomizu-dera per la sua vista panoramica. Passeggiamo per le storiche stradine di Higashiyama, Sannenzaka e Ninnenzaka, e concludiamo con una visita al Santuario Yasaka.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184550.png"
    },
    {
      "date": "2025-11-24",
      "location": "Osaka",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "HIYORI Stay Kyoto Kamogawa",
      "activities": "Giornata nella vivace Osaka, raggiungibile in 30 minuti di treno JR da Kyoto. Visitiamo l'imponente Castello di Osaka, poi esploriamo il quartiere di Shinsaibashi per lo shopping. La serata è a Dotonbori, il cuore pulsante della città, con le sue insegne al neon e l'incredibile street food. Assaggiamo takoyaki e okonomiyaki prima di rientrare a Kyoto.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184727.png"
    },
    {
      "date": "2025-11-25",
      "location": "Nara",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "HIYORI Stay Kyoto Kamogawa",
      "activities": "Oggi andiamo a Nara, raggiungibile in 45 minuti di treno JR da Kyoto. L'attrazione principale è il Parco di Nara, dove i cervi girano liberamente. All'interno del parco, visitiamo il Tempio Todai-ji con la sua enorme statua del Buddha e il Santuario Kasuga Taisha, famoso per le migliaia di lanterne. Una gita facile e rilassante, con rientro a Kyoto in serata.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184808.png"
    },
    {
      "date": "2025-11-26",
      "location": "Himeji",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "HIYORI Stay Kyoto Kamogawa",
      "activities": "L'escursione di oggi ci porta al castello più bello del Giappone. Prendiamo uno Shinkansen da Kyoto per Himeji (circa 1 ora). Visitiamo il Castello di Himeji, noto come \"I'Airone Bianco\", una magnifica struttura originale del periodo feudale. Successivamente, esploriamo il vicino\ngiardino Koko-en prima di rientrare a Kyoto nel tardo pomeriggio.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184838.png"
    },
    {
      "date": "2025-11-27",
      "location": "Kyoto",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "HIYORI Stay Kyoto Kamogawa",
      "activities": "Dedichiamo l'ultimo giorno a Kyoto alla parte nordoccidentale. Iniziamo dalla suggestiva foresta di bambù di Arashiyama e visitiamo il vicino Tempio Tenryu-ji. Nel pomeriggio, ammiriamo il Kinkaku-ji, il famoso Padiglione d'Oro. Se avanza tempo, una visita al Tempio Ryoan-ji, con il suo enigmatico giardino di rocce, completerà la giornata.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20184918.png"
    },
    {
      "date": "2025-11-28",
      "location": "Hiroshima",
      "isFlight": false,
      "isCruise": false,
      "accommodation": "HIYORI Stay Kyoto Kamogawa",
      "activities": "Escursione intensa ma imperdibile. Partiamo molto presto da Kyoto con lo Shinkansen per Hiroshima (1h 40m). Dedichiamo la mattinata al Parco e al Museo della Pace. Dopo pranzo, treno e traghetto per l'isola di Miyajima per ammirare il famoso torii \"galleggiante\" del Santuario di Itsukushima. Possiamo anche salire sul Monte Misen per una vista spettacolare. Rientro a Kyoto in tarda serata.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20185004.png"
    },
    {
      "date": "2025-11-29",
      "location": "Volo per l'Italia",
      "isFlight": true,
      "isCruise": false,
      "accommodation": "Volo per l'Italia",
      "activities": "È il nostro ultimo giorno in Giappone. Dopo il check-out, lasceremo i bagagli in hotel o negli armadietti della stazione di Kyoto per goderci la giornata. La mattinata sarà dedicata allo shopping dell'ultimo minuto nel gigantesco complesso della stazione, esplorando negozi come Isetan e The Cube, o in alternativa, facendo un'ultima visita culturale al vicino Tempio To-ji. Dopo un pranzo rilassato, avremo ancora tempo per qualche acquisto. Intorno alle 18:30, recupereremo i bagagli e prenderemo il treno Haruka Express per l'aeroporto del Kansai (KIX), per arrivare in tempo per il nostro volo delle 22:50.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/Screenshot%202025-08-04%20185142.png"
    },
    {
      "date": "2025-11-30",
      "location": "Bologna",
      "isFlight": true,
      "isCruise": false,
      "accommodation": "Casa",
      "activities": "L'arrivo a Bologna è previsto per le 9:55.",
      "image": "https://raw.githubusercontent.com/rigelpd/itinerario-giappone/main/casa.png"
    }
  ],
  "tours": [],
  "budget": {
    "total": 0,
    "expenses": [
      {
        "id": 1755869919255,
        "description": "Volo andata Bologna Tokyo ritorno Osaka Bologna (2 persone)",
        "amount": 2230,
        "category": "flights",
        "person": "Margherita",
        "status": "paid",
        "onSplid": true
      },
      {
        "id": 1755870266762,
        "description": "Hotel a Tokyo",
        "amount": 1224,
        "category": "hotels",
        "person": "Margherita",
        "status": "booked",
        "onSplid": false,
        "nights": 7
      },
      {
        "id": 1755870303651,
        "description": "Ryokan a Kyoto",
        "amount": 394,
        "category": "hotels",
        "person": "Margherita",
        "status": "booked",
        "onSplid": false,
        "nights": 1
      },
      {
        "id": 1755870338956,
        "description": "Hotel a Kyoto",
        "amount": 1096,
        "category": "hotels",
        "person": "Margherita",
        "status": "booked",
        "onSplid": false,
        "nights": 6
      }
    ]
  },
  "usefulLinks": [
    {
      "id": 1755870422159,
      "title": "Japan Guide - Guida Completa",
      "url": "https://www.japan-guide.com/"
    },
    {
      "id": 1755870439896,
      "title": "Ente Nazionale del Turismo Giapponese (JNTO)",
      "url": "https://www.japan.travel/it/it/"
    },
    {
      "id": 1755870471329,
      "title": "Tokyo Metro (Mappa e Biglietti)",
      "url": "https://www.tokyometro.jp/en/index.html"
    },
    {
      "id": 1755870478585,
      "title": "Biglietti Tokyo Skytree",
      "url": "https://www.tokyo-skytree.jp/en/ticket/"
    },
    {
      "id": 1755870498866,
      "title": "Biglietti Museo Ghibli (Richiede prenotazione)",
      "url": "https://www.ghibli-museum.jp/en/tickets/"
    },
    {
      "id": 1755870513194,
      "title": "Biglietti teamLab Borderless",
      "url": "https://www.teamlab.art/e/borderless-tokyo/"
    },
    {
      "id": 1755870538803,
      "title": "Trasporti a Kyoto (Bus & Metro)",
      "url": "https://www.city.kyoto.lg.jp/kotsu/page/0000028378.html"
    },
    {
      "id": 1755870547123,
      "title": "Osaka Amazing Pass",
      "url": "https://www.osp.osaka-info.jp/en/"
    },
    {
      "id": 1755870561764,
      "title": "Accesso a Nara (Kintetsu Railway)",
      "url": "https://www.kintetsu.co.jp/foreign/english/sightseeing/nara.html"
    },
    {
      "id": 1755870577548,
      "title": "Castello di Himeji (Sito Ufficiale)",
      "url": "https://www.city.himeji.lg.jp/castle/index.html"
    },
    {
      "id": 1755870591060,
      "title": "Museo della Pace di Hiroshima",
      "url": "https://hpmmuseum.jp/modules/info/index.php?action=PageView&page_id=51"
    },
    {
      "id": 1755870605373,
      "title": "Traghetto per Miyajima (JR Ferry)",
      "url": "https://www.jr-miyajimaferry.co.jp/en/"
    },
    {
      "id": 1755870620958,
      "title": "Informazioni Suica & Pasmo (IC Cards)",
      "url": "https://www.japan-guide.com/e/e2359_003.html"
    },
    {
      "id": 1755870637166,
      "title": "Nikko Pass (Tobu Railway)",
      "url": "https://www.tobu.co.jp/en/ticket/nikko/"
    },
    {
      "id": 1755870651846,
      "title": "Hakone Free Pass (Odakyu Railway)",
      "url": "https://www.odakyu.jp/english/passes/hakone/"
    }
  ]
};

        // --- GITHUB MODAL STATE ---
        let currentImageTargetId = null;

        // --- UTILITY & HELPER FUNCTIONS ---
        const formatCurrency = (value) => new Intl.NumberFormat('it-IT', { style: 'currency', currency: 'EUR' }).format(value);
        function formatOffset(offset) { const sign = offset >= 0 ? '+' : '-'; const absOffset = Math.abs(offset); const hours = String(Math.floor(absOffset)).padStart(2, '0'); const minutes = String((absOffset % 1) * 60).padStart(2, '0'); return `${sign}${hours}:${minutes}`; }
        
        function calculateDurationString(depTimeValue, arrTimeValue, depTzOffset, arrTzOffset) {
            if (!depTimeValue || !arrTimeValue) return '';
            try {
                let depDate, arrDate;
                if (depTzOffset !== null && arrTzOffset !== null) { // Flight with timezone
                    depDate = new Date(`${depTimeValue}:00${formatOffset(depTzOffset)}`);
                    arrDate = new Date(`${arrTimeValue}:00${formatOffset(arrTzOffset)}`);
                } else { // Tour without timezone
                    depDate = new Date(depTimeValue);
                    arrDate = new Date(arrTimeValue);
                }
                let diff = arrDate.getTime() - depDate.getTime();
                if (isNaN(diff)) return "Date non valide";
                if (diff < 0) return "Arrivo prima della partenza";
                
                const diffDays = Math.floor(diff / 86400000);
                diff -= diffDays * 86400000;
                const diffHours = Math.floor(diff / 3600000);
                diff -= diffHours * 3600000;
                const diffMinutes = Math.round(diff / 60000);
                
                let durationString = 'Durata: ';
                if (diffDays > 0) durationString += `${diffDays}g `;
                durationString += `${diffHours}h ${diffMinutes}m`;
                return durationString;
            } catch(e) {
                return "Date non valide";
            }
        }

        function updateGmapsLink(inputElement) {
            const link = inputElement.parentElement.querySelector('.gmaps-link');
            if (link) link.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(inputElement.value)}`;
        }
        
        function autoGrowTextarea(element) { if(element) { element.style.height = 'auto'; element.style.height = (element.scrollHeight) + 'px'; } }
        async function compressImage(file, maxWidth = 1280, maxHeight = 1280, quality = 0.8) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        let width = img.width;
                        let height = img.height;
                        if (width > height) { if (width > maxWidth) { height *= maxWidth / width; width = maxWidth; } } else { if (height > maxHeight) { width *= maxHeight / height; height = maxHeight; } }
                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        resolve(canvas.toDataURL('image/jpeg', quality));
                    };
                    img.onerror = (error) => reject(error);
                };
                reader.onerror = (error) => reject(error);
            });
        }
        
        // --- DATA MANAGEMENT FUNCTIONS ---
        function saveData() {
            try {
                const dataToSave = buildDataObjectFromDOM();
                currentData = dataToSave; // Update in-memory state
                localStorage.setItem(DATA_STORAGE_KEY, JSON.stringify(dataToSave));
            } catch (e) {
                console.error("Errore nel salvataggio dei dati:", e);
            }
        }

        function loadData() {
            try {
                const savedData = localStorage.getItem(DATA_STORAGE_KEY);
                if (savedData) return JSON.parse(savedData);
            } catch (e) {
                console.error("Errore nel caricamento dei dati:", e);
                localStorage.removeItem(DATA_STORAGE_KEY);
            }
            return JSON.parse(JSON.stringify(defaultFullData));
        }
        
        function buildDataObjectFromDOM() {
            if (!isAdminMode) return currentData; 

            const data = {
                main: {},
                flights: [],
                itinerary: [],
                tours: [],
                budget: currentData.budget, // Budget is managed directly in currentData
                usefulLinks: currentData.usefulLinks // Links are managed directly
            };

            data.main.title = document.getElementById('main-title-input')?.value || currentData.main.title;
            data.main.image = document.getElementById('main-image-preview').src;

            document.querySelectorAll('#flights-container .flight-card').forEach(card => {
                const idPrefix = card.dataset.idprefix;
                data.flights.push({
                    idPrefix,
                    title: document.getElementById(`flight-${idPrefix}-title`).value,
                    depAirport: document.getElementById(`${idPrefix}-dep-airport`).value,
                    arrAirport: document.getElementById(`${idPrefix}-arr-airport`).value,
                    depTime: document.getElementById(`${idPrefix}-dep-time`).value,
                    arrTime: document.getElementById(`${idPrefix}-arr-time`).value,
                    depTz: parseFloat(document.getElementById(`${idPrefix}-dep-tz`).value),
                    arrTz: parseFloat(document.getElementById(`${idPrefix}-arr-tz`).value),
                });
            });

            document.querySelectorAll('#itinerary-container .day-card-wrapper').forEach((card, index) => {
                const dayId = `day${index + 1}`;
                data.itinerary.push({
                    date: document.getElementById(`${dayId}-date`).value,
                    location: document.getElementById(`${dayId}-location`).value,
                    isFlight: document.getElementById(`${dayId}-flight-check`).checked,
                    isCruise: document.getElementById(`${dayId}-cruise-check`).checked,
                    accommodation: document.getElementById(`${dayId}-accommodation`).value,
                    activities: document.getElementById(`${dayId}-activities`).value,
                    image: document.getElementById(`${dayId}-image-preview`).src,
                });
            });

            document.querySelectorAll('#tours-container .tour-card').forEach(card => {
                const tourId = card.dataset.id;
                data.tours.push({
                    id: parseInt(tourId),
                    title: document.getElementById(`tour-${tourId}-title`).value,
                    depTime: document.getElementById(`tour-${tourId}-dep-time`).value,
                    arrTime: document.getElementById(`tour-${tourId}-arr-time`).value,
                    type: document.getElementById(`tour-${tourId}-type`).value,
                    description: document.getElementById(`tour-${tourId}-description`).value,
                });
            });

            return data;
        }

        function resetItinerary() {
            if (confirm("Sei sicuro di voler cancellare TUTTI i dati e ripristinare l'itinerario originale? L'operazione è irreversibile.")) {
                localStorage.removeItem(DATA_STORAGE_KEY);
                sessionStorage.removeItem('siteAccessGranted');
                sessionStorage.removeItem('isAdmin');
                location.reload();
            }
        }

        // --- HTML EXPORT FUNCTION ---
        function exportHTML() {
            saveData(); 
            const latestData = loadData();
            let htmlString = document.documentElement.outerHTML;
            
            const newDataString = JSON.stringify(latestData, null, 2)
                .replace(/</g, '\\u003c')
                .replace(/>/g, '\\u003e');

            const placeholderRegex = /const defaultFullData = {[\s\S]*?};/;
            htmlString = htmlString.replace(placeholderRegex, `const defaultFullData = ${newDataString};`);

            htmlString = htmlString.replace(/<body class="[^"]*">/, '<body class="content-hidden">');
            htmlString = htmlString.replace(/(<div id="site-access-modal"[^>]*class=")([^"]*)(")/, (match, p1, p2, p3) => {
                const classes = p2.split(' ').filter(c => c !== 'hidden').join(' ');
                return `${p1}${classes}${p3}`;
            });
            const blob = new Blob([htmlString], { type: 'text/html' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'index.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(a.href);
        }

        // --- PDF EXPORT FUNCTION ---
        async function saveAsPDF(quality = PDF_QUALITY_PRESETS.medium) {
            const pdfBtn = document.getElementById('pdf-btn');
            pdfBtn.textContent = `Generazione PDF (${quality.text})...`;
            pdfBtn.disabled = true;

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = pdf.internal.pageSize.getHeight();
            const margin = 15;
            const contentWidth = pdfWidth - (margin * 2);
            let y = margin;

            const addElementToPdf = async (element) => {
                const canvas = await html2canvas(element, { scale: quality.scale, useCORS: true, logging: false, width: element.offsetWidth, windowWidth: element.offsetWidth });
                const imgData = canvas.toDataURL('image/jpeg', quality.jpegQuality);
                const imgHeight = (canvas.height * contentWidth) / canvas.width;
                if (y + imgHeight > pdfHeight - margin) { pdf.addPage(); y = margin; }
                pdf.addImage(imgData, 'JPEG', margin, y, contentWidth, imgHeight);
                y += imgHeight + 5;
            };
            
            const printContainer = document.createElement('div');
            printContainer.style.cssText = 'position: absolute; left: -9999px; width: 1024px; background-color: white;';
            document.body.appendChild(printContainer);

            try {
                const prepareElementForPrint = (originalElement) => {
                    const clone = originalElement.cloneNode(true);
                    clone.style.padding = '10px';
                    clone.style.marginBottom = '0';
                    clone.classList.remove('hidden');
                    clone.querySelectorAll('.no-print, button, input[type="file"], label[for*="-image-input"], .image-controls').forEach(el => el.remove());
                    clone.querySelectorAll('input, textarea, select').forEach(el => {
                        const p = document.createElement('div');
                        let value = el.value;
                        if (el.tagName === 'SELECT') value = el.options[el.selectedIndex].text;
                        else if (el.type === 'date') value = new Date(value + 'T00:00:00').toLocaleDateString('it-IT', { weekday: 'long', day: '2-digit', month: 'long', year: 'numeric' });
                        else if (el.type === 'datetime-local') value = new Date(value).toLocaleString('it-IT', { day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' });
                        p.innerHTML = (value || '').replace(/\n/g, '<br>');
                        p.className = 'readonly-text';
                        el.parentNode.replaceChild(p, el);
                    });
                    clone.querySelectorAll('img[id$="-preview"]').forEach(img => { if (img.src && (img.src.startsWith('data:') || img.src.startsWith('http'))) { img.style.display = 'block'; img.classList.remove('hidden'); } else { img.remove(); } });
                    clone.querySelectorAll('.image-placeholder').forEach(el => el.remove());
                    clone.querySelectorAll('.card').forEach(c => { c.style.boxShadow = 'none'; c.style.border = '1px solid #e5e7eb'; c.style.transform = 'none'; });
                    printContainer.appendChild(clone);
                    return clone;
                };

                await addElementToPdf(prepareElementForPrint(document.querySelector('header')));
                printContainer.innerHTML = '';
                await addElementToPdf(prepareElementForPrint(document.getElementById('calendar-summary')));
                printContainer.innerHTML = '';
                
                pdf.addPage(); y = margin;
                const itineraryTitle = document.createElement('h2');
                itineraryTitle.className = 'text-2xl mb-4 border-b pb-2 font-bold text-gray-700';
                itineraryTitle.textContent = 'Itinerario Dettagliato';
                await addElementToPdf(prepareElementForPrint(itineraryTitle));
                printContainer.innerHTML = '';

                for (const card of document.querySelectorAll('#itinerary-container .day-card-wrapper')) {
                    await addElementToPdf(prepareElementForPrint(card));
                    printContainer.innerHTML = '';
                }

                if (document.querySelector('#flights-content .flight-card')) {
                    pdf.addPage(); y = margin;
                    const flightsTitle = document.createElement('h2');
                    flightsTitle.className = 'text-2xl mb-4 border-b pb-2 font-bold text-gray-700';
                    flightsTitle.textContent = 'Riepilogo Voli';
                    await addElementToPdf(prepareElementForPrint(flightsTitle));
                    printContainer.innerHTML = '';
                    for (const card of document.querySelectorAll('#flights-content .flight-card')) {
                        await addElementToPdf(prepareElementForPrint(card));
                        printContainer.innerHTML = '';
                    }
                }

                if (document.querySelector('#tours-content .tour-card')) {
                    pdf.addPage(); y = margin;
                    const toursTitle = document.createElement('h2');
                    toursTitle.className = 'text-2xl mb-4 border-b pb-2 font-bold text-gray-700';
                    toursTitle.textContent = 'Riepilogo Tour';
                    await addElementToPdf(prepareElementForPrint(toursTitle));
                    printContainer.innerHTML = '';
                    for (const card of document.querySelectorAll('#tours-content .tour-card')) {
                        await addElementToPdf(prepareElementForPrint(card));
                        printContainer.innerHTML = '';
                    }
                }

                if(document.getElementById('budget-content').innerHTML.trim() !== ''){
                    pdf.addPage(); y = margin;
                    await addElementToPdf(prepareElementForPrint(document.getElementById('budget-content')));
                    printContainer.innerHTML = '';
                }
                
                const titleEl = document.getElementById('main-title-input') || document.querySelector('#main-title-container h1');
                const title = titleEl.value || titleEl.textContent;
                pdf.save(`itinerario_${title.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.pdf`);

            } catch (error) {
                console.error("Errore durante la generazione del PDF:", error);
                alert("Si è verificato un errore durante la generazione del PDF. Controlla la console per i dettagli.");
            } finally {
                document.body.removeChild(printContainer);
                pdfBtn.textContent = 'Salva come PDF';
                pdfBtn.disabled = false;
            }
        }
        
        // --- RENDER FUNCTIONS ---
        function renderApp(data, adminMode) {
            isAdminMode = adminMode;
            document.body.classList.toggle('admin-mode', adminMode);
            
            const mainTitleContainer = document.getElementById('main-title-container');
            const editorSubtitle = document.getElementById('editor-subtitle');

            if (adminMode) {
                mainTitleContainer.innerHTML = `<h1 class="text-3xl md:text-4xl font-bold text-gray-800"><input type="text" id="main-title-input" value="${data.main.title}" class="w-full text-center border-0 focus:ring-0 bg-transparent p-0 m-0 font-bold text-3xl md:text-4xl"></h1>`;
                editorSubtitle.classList.remove('hidden');
            } else {
                mainTitleContainer.innerHTML = `<h1 class="text-3xl md:text-4xl font-bold text-gray-800">${data.main.title}</h1>`;
                editorSubtitle.classList.add('hidden');
            }

            renderImage('main', data.main.image);
            createDetailedItinerary(data.itinerary, adminMode);
            createFlightsList(data.flights, adminMode);
            renderTours(data.tours, adminMode);
            renderBudget(data.budget, adminMode);
            renderUsefulLinks(data.usefulLinks, adminMode);
            updateCalendar(data.itinerary);

            if (adminMode && data.itinerary.length > 0) {
                data.itinerary.sort((a, b) => new Date(a.date) - new Date(b.date));
                document.getElementById('start-date-input').value = data.itinerary[0].date;
                document.getElementById('end-date-input').value = data.itinerary[data.itinerary.length - 1].date;
            }

            setupDynamicEventListeners();
        }
        
        function renderImage(targetId, imageUrl) {
            const preview = document.getElementById(`${targetId}-image-preview`);
            const placeholder = document.getElementById(`${targetId}-image-placeholder`);
            const controls = document.getElementById(`${targetId}-image-controls`);
            const hasImage = imageUrl && (imageUrl.startsWith('data:') || imageUrl.startsWith('http'));

            if (preview) { preview.src = hasImage ? imageUrl : ''; preview.style.display = hasImage ? 'block' : 'none'; }
            if (placeholder) placeholder.style.display = hasImage ? 'none' : 'flex';
            
            if (controls) {
                controls.style.display = (hasImage && isAdminMode) ? 'flex' : 'none';
                if (hasImage && isAdminMode) {
                    controls.innerHTML = `
                        <button class="github-open-btn p-2 bg-white text-gray-800 rounded-full shadow-md hover:bg-gray-200" data-target-id="${targetId}" title="Cambia immagine">${PENCIL_ICON_SVG}</button>
                        <button class="remove-image-btn p-2 bg-red-500 text-white rounded-full shadow-md hover:bg-red-600" data-target-id="${targetId}" title="Rimuovi immagine">${TRASH_ICON_SVG}</button>`;
                }
            }
        }

        function updateCalendar(itineraryData) {
            const container = document.getElementById('calendar-container');
            container.innerHTML = '';
            if (!itineraryData || itineraryData.length === 0) return;
            
            itineraryData.sort((a, b) => new Date(a.date) - new Date(b.date));
            const tripEvents = new Map(itineraryData.map(item => [item.date, `${item.isFlight ? '✈️' : ''}${item.isCruise ? '🚢' : ''}`]).filter(entry => entry[1]));
            const tripDates = new Set(itineraryData.map(item => item.date));
            const firstDate = new Date(itineraryData[0].date + 'T12:00:00Z');
            const lastDate = new Date(itineraryData[itineraryData.length - 1].date + 'T12:00:00Z');
            let currentDate = new Date(Date.UTC(firstDate.getUTCFullYear(), firstDate.getUTCMonth(), 1));

            while (currentDate <= lastDate) {
                const year = currentDate.getUTCFullYear();
                const month = currentDate.getUTCMonth();
                const monthContainer = document.createElement('div');
                monthContainer.className = 'w-full md:w-auto';
                monthContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-center mb-2 text-indigo-700">${new Date(year, month).toLocaleDateString('it-IT', { month: 'long', year: 'numeric' })}</h3>
                    <div class="grid grid-cols-7 gap-1 text-center text-sm">
                        ${['Lun', 'Mar', 'Mer', 'Gio', 'Ven', 'Sab', 'Dom'].map(day => `<div class="font-bold text-gray-500">${day}</div>`).join('')}
                    </div>`;
                const grid = monthContainer.querySelector('.grid');
                const firstDayOfMonth = (new Date(year, month, 1).getDay() + 6) % 7;
                for (let i = 0; i < firstDayOfMonth; i++) grid.insertAdjacentHTML('beforeend', '<div></div>');

                const daysInMonth = new Date(year, month + 1, 0).getDate();
                for (let day = 1; day <= daysInMonth; day++) {
                    const thisDate = new Date(Date.UTC(year, month, day));
                    const dateString = thisDate.toISOString().split('T')[0];
                    const isTripDay = tripDates.has(dateString);
                    const dayEl = document.createElement('div');
                    dayEl.className = 'calendar-day';
                    if (isTripDay) {
                        dayEl.classList.add('trip-day');
                        dayEl.dataset.date = dateString;
                    }
                    if (thisDate.toDateString() === new Date().toDateString()) dayEl.classList.add('today');
                    dayEl.innerHTML = `<span class="day-number">${day}</span>${isTripDay && tripEvents.has(dateString) ? `<div class="calendar-icons">${tripEvents.get(dateString)}</div>` : ''}`;
                    grid.appendChild(dayEl);
                }
                container.appendChild(monthContainer);
                currentDate.setUTCMonth(currentDate.getUTCMonth() + 1);
            }
        }

        function createDetailedItinerary(data, adminMode) {
            const container = document.getElementById('itinerary-container');
            const mapIconSvg = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" /></svg>`;
            if (data.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500">Nessun giorno definito. Aggiungi le date di inizio e fine in modalità admin per iniziare.</p>';
                return;
            }
            container.innerHTML = data.map((item, index) => {
                const dayId = `day${index + 1}`;
                const dateObj = new Date(item.date + 'T12:00:00Z');
                const dateString = dateObj.toLocaleDateString('it-IT', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', timeZone: 'UTC' });
                const accommodationLink = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.accommodation)}`;
                const hasImage = item.image && (item.image.startsWith('data:') || item.image.startsWith('http'));
                return `<div class="card day-card flex flex-col md:flex-row gap-6 items-stretch day-card-wrapper" data-date="${item.date}">
                        <div class="w-full md:w-1/2 flex flex-col">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">${dateString} (Giorno ${index + 1})</h3>
                            <div class="grid grid-cols-1 gap-4 flex-grow">
                                ${adminMode ? `<div><label for="${dayId}-date">Data</label><input type="date" id="${dayId}-date" value="${item.date}"></div><div><label for="${dayId}-location">Località</label><input type="text" id="${dayId}-location" value="${item.location}"></div><div><label for="${dayId}-accommodation">Alloggio</label><div class="relative flex items-center"><input type="text" id="${dayId}-accommodation" value="${item.accommodation}" class="pr-10"><a href="${accommodationLink}" target="_blank" class="gmaps-link absolute right-0 top-0 h-full flex items-center px-3 text-gray-400 hover:text-indigo-600" data-input-id="${dayId}-accommodation" title="Apri in Google Maps">${mapIconSvg}</a></div></div><div class="flex-grow flex flex-col"><label for="${dayId}-activities">Attività</label><textarea id="${dayId}-activities">${item.activities}</textarea></div><div class="flex items-center gap-6 mt-2"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="${dayId}-flight-check" ${item.isFlight ? 'checked' : ''} class="w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500"> <span>✈️ Volo</span></label><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="${dayId}-cruise-check" ${item.isCruise ? 'checked' : ''} class="w-5 h-5 rounded text-sky-600 focus:ring-sky-500"> <span>🚢 Crociera</span></label></div>` : `<div><label>Località</label><div class="readonly-text">${item.location}</div></div><div><label>Alloggio</label><div class="flex items-center justify-between readonly-text"><span class="flex-grow">${item.accommodation}</span><a href="${accommodationLink}" target="_blank" title="Apri in Google Maps" class="p-2 text-gray-400 hover:text-indigo-600">${mapIconSvg}</a></div></div><div class="flex-grow flex flex-col"><label>Attività</label><div class="readonly-text">${item.activities.replace(/\n/g, '<br>')}</div></div>`}
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 relative">
                            <img id="${dayId}-image-preview" class="object-cover w-full h-full rounded-lg" style="display: ${hasImage ? 'block' : 'none'}" src="${hasImage ? item.image : ''}" alt="Anteprima"/>
                            <div id="${dayId}-image-placeholder" class="image-placeholder w-full h-full bg-slate-200 rounded-lg items-center justify-center border-2 border-dashed border-gray-400" style="display: ${hasImage ? 'none' : 'flex'}">
                                 <div class="text-center text-gray-600"><div class="admin-only-flex justify-center gap-4"><label for="${dayId}-image-input" class="px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 text-sm">Carica File</label><button class="github-open-btn px-4 py-2 bg-gray-800 text-white rounded-lg shadow-sm hover:bg-gray-900 text-sm" data-target-id="${dayId}">da GitHub</button></div><p class="user-only font-semibold">Nessuna immagine</p></div>
                            </div>
                            <div id="${dayId}-image-controls" class="image-controls admin-only-flex absolute top-2 right-2 gap-2 z-10" style="display: ${hasImage && adminMode ? 'flex' : 'none'};"></div>
                            <input type="file" id="${dayId}-image-input" class="hidden" accept="image/*">
                        </div>
                    </div>`;
            }).join('');
        }

        function createFlightsList(data, adminMode) {
            const container = document.getElementById('flights-container');
            const trashIconSvg = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>`;
            const createTimezoneSelect = (id, selectedOffset) => `<select id="${id}">${TIMEZONES.map(tz => `<option value="${tz.offset}" ${tz.offset == selectedOffset ? 'selected' : ''}>${tz.name}</option>`).join('')}</select>`;
            const flightCardsHTML = data.map(flight => {
                const idPrefix = flight.idPrefix;
                const depTzName = TIMEZONES.find(tz => tz.offset == flight.depTz)?.name || `UTC${flight.depTz >= 0 ? '+' : ''}${flight.depTz}`;
                const arrTzName = TIMEZONES.find(tz => tz.offset == flight.arrTz)?.name || `UTC${flight.arrTz >= 0 ? '+' : ''}${flight.arrTz}`;
                return `<div class="card flight-card" data-idprefix="${idPrefix}">
                        <div class="flex justify-between items-start mb-4">
                             <h3 class="text-xl font-semibold text-indigo-700 flex-grow"><span>✈️ ${adminMode ? `<input type="text" id="flight-${idPrefix}-title" value="${flight.title}" class="inline-block w-auto p-1 bg-transparent border-0 border-b focus:ring-0 font-semibold text-xl text-indigo-700">` : flight.title}</span></h3>
                            <button data-flight-id="${idPrefix}" class="delete-flight-btn admin-only text-gray-400 hover:text-red-500 p-1" title="Rimuovi volo">${trashIconSvg}</button>
                        </div>
                        ${adminMode ? `<div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label for="${idPrefix}-dep-airport">Aeroporto Partenza</label><input type="text" id="${idPrefix}-dep-airport" value="${flight.depAirport}"></div><div><label for="${idPrefix}-arr-airport">Aeroporto Arrivo</label><input type="text" id="${idPrefix}-arr-airport" value="${flight.arrAirport}"></div><div><label for="${idPrefix}-dep-time">Data/Ora Partenza</label><input type="datetime-local" id="${idPrefix}-dep-time" value="${flight.depTime}"></div><div><label for="${idPrefix}-arr-time">Data/Ora Arrivo</label><input type="datetime-local" id="${idPrefix}-arr-time" value="${flight.arrTime}"></div><div><label for="${idPrefix}-dep-tz">Fuso Orario Partenza</label>${createTimezoneSelect(`${idPrefix}-dep-tz`, flight.depTz)}</div><div><label for="${idPrefix}-arr-tz">Fuso Orario Arrivo</label>${createTimezoneSelect(`${idPrefix}-arr-tz`, flight.arrTz)}</div></div>` : `<div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label>Aeroporto Partenza</label><div class="readonly-text">${flight.depAirport}</div></div><div><label>Aeroporto Arrivo</label><div class="readonly-text">${flight.arrAirport}</div></div><div><label>Data/Ora Partenza</label><div class="readonly-text">${flight.depTime ? new Date(flight.depTime).toLocaleString('it-IT', { day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' }) : ''}</div></div><div><label>Data/Ora Arrivo</label><div class="readonly-text">${flight.arrTime ? new Date(flight.arrTime).toLocaleString('it-IT', { day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' }) : ''}</div></div><div><label>Fuso Orario Partenza</label><div class="readonly-text">${depTzName}</div></div><div><label>Fuso Orario Arrivo</label><div class="readonly-text">${arrTzName}</div></div></div>`}
                    </div>`;
            }).join('');
            const summaryTableRows = data.map(flight => `<tr class="border-b last:border-b-0"><td class="py-2 pr-4 font-medium">${flight.title}</td><td class="py-2 pl-4 text-right">${calculateDurationString(flight.depTime, flight.arrTime, flight.depTz, flight.arrTz)}</td></tr>`).join('');
            container.innerHTML = `${flightCardsHTML}<div class="flex justify-center mt-6"><button id="add-flight-btn" class="admin-only px-6 py-2 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 transition-colors">Aggiungi Volo</button></div><div class="card mt-8"><h3 class="text-xl font-semibold text-gray-700 mb-4">Riepilogo Durata Voli</h3><table id="flights-summary-table" class="w-full text-sm"><thead><tr class="border-b-2"><th class="text-left font-semibold pb-2">Volo</th><th class="text-right font-semibold pb-2">Durata</th></tr></thead><tbody>${summaryTableRows}</tbody></table></div>`;
        }

        function renderTours(data, adminMode) {
            const container = document.getElementById('tours-container');
            const tourCards = (data || []).map(tour => {
                const tourId = tour.id;
                const icon = TOUR_TYPES[tour.type]?.split(' ')[0] || '🗺️';
                return `<div class="card tour-card" data-id="${tourId}">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold text-green-700 flex-grow"><span>${icon} ${adminMode ? `<input type="text" id="tour-${tourId}-title" value="${tour.title}" class="inline-block w-auto p-1 bg-transparent border-0 border-b focus:ring-0 font-semibold text-xl text-green-700">` : tour.title}</span></h3>
                            ${!adminMode ? `<span id="tour-${tourId}-duration" class="text-base font-medium text-green-800 ml-4 flex-shrink-0"></span>` : ''}
                            <button data-tour-id="${tourId}" class="delete-tour-btn admin-only text-gray-400 hover:text-red-500 p-1" title="Rimuovi tour"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button>
                        </div>
                        ${adminMode ? `<div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label for="tour-${tourId}-dep-time">Data/Ora Partenza</label><input type="datetime-local" id="tour-${tourId}-dep-time" value="${tour.depTime || ''}"></div><div><label for="tour-${tourId}-arr-time">Data/Ora Arrivo</label><input type="datetime-local" id="tour-${tourId}-arr-time" value="${tour.arrTime || ''}"></div><div class="md:col-span-2"><label for="tour-${tourId}-type">Tipologia</label><select id="tour-${tourId}-type">${Object.entries(TOUR_TYPES).map(([k, v]) => `<option value="${k}" ${k === tour.type ? 'selected' : ''}>${v}</option>`).join('')}</select></div><div class="md:col-span-2"><label for="tour-${tourId}-description">Descrizione</label><textarea id="tour-${tourId}-description">${tour.description || ''}</textarea></div></div><p id="tour-${tourId}-duration" class="mt-4 text-lg font-semibold text-green-800"></p>` : `<div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label>Data/Ora Partenza</label><div class="readonly-text">${tour.depTime ? new Date(tour.depTime).toLocaleString('it-IT', { day: '2-digit', month: 'long', hour: '2-digit', minute: '2-digit' }) : ''}</div></div><div><label>Data/Ora Arrivo</label><div class="readonly-text">${tour.arrTime ? new Date(tour.arrTime).toLocaleString('it-IT', { day: '2-digit', month: 'long', hour: '2-digit', minute: '2-digit' }) : ''}</div></div><div class="md:col-span-2"><label>Tipologia</label><div class="readonly-text">${TOUR_TYPES[tour.type]}</div></div><div class="md:col-span-2"><label>Descrizione</label><div class="readonly-text">${(tour.description || '').replace(/\n/g, '<br>')}</div></div></div>`}
                    </div>`;
            }).join('');
            container.innerHTML = `${tourCards}<div class="flex justify-center mt-6"><button id="add-tour-btn" class="admin-only px-6 py-2 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 transition-colors">Aggiungi Tour</button></div>`;
            (data || []).forEach(tour => {
                const durationEl = document.getElementById(`tour-${tour.id}-duration`);
                if(durationEl) durationEl.textContent = calculateDurationString(tour.depTime, tour.arrTime, null, null);
            });
        }

        function renderBudget(budgetData, adminMode) {
            const container = document.getElementById('budget-content');
            if (!budgetData) { container.innerHTML = '<p>Dati budget non disponibili.</p>'; return; }

            // 1. CALCULATIONS
            const totalBudget = parseFloat(budgetData.total) || 0;
            const totalPaid = budgetData.expenses
                .filter(e => e.status === 'paid')
                .reduce((sum, expense) => sum + (parseFloat(expense.amount) || 0), 0);
            const totalBooked = budgetData.expenses
                .filter(e => e.status === 'booked')
                .reduce((sum, expense) => sum + (parseFloat(expense.amount) || 0), 0);
            const totalSpent = totalPaid + totalBooked;
            const remaining = totalBudget - totalSpent;

            const paidPercentage = totalBudget > 0 ? (totalPaid / totalBudget) * 100 : 0;
            const bookedPercentage = totalBudget > 0 ? (totalBooked / totalBudget) * 100 : 0;

            // 2. ADMIN FORM HTML
            const categoryOptions = Object.entries(BUDGET_CATEGORIES).map(([key, value]) => `<option value="${key}">${value}</option>`).join('');
            const adminForm = `
                <div class="card bg-slate-50 border-indigo-300 admin-only-grid">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4 col-span-full">Aggiungi Nuova Spesa</h3>
                    <form id="add-expense-form" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end">
                        <div class="lg:col-span-2"><label for="expense-desc">Descrizione</label><input type="text" id="expense-desc" required></div>
                        <div><label for="expense-amount">Importo (€)</label><input type="number" id="expense-amount" step="0.01" required></div>
                        <div><label for="expense-category">Categoria</label><select id="expense-category">${categoryOptions}</select></div>
                        <div id="expense-nights-container" class="hidden"><label for="expense-nights">Numero Notti</label><input type="number" id="expense-nights" min="1"></div>
                        <div><label for="expense-person">Pagato da</label><input type="text" id="expense-person" required></div>
                        <div><label for="expense-status">Stato</label><select id="expense-status"><option value="paid">Pagata</option><option value="booked">Prenotata</option></select></div>
                        <div class="flex items-center"><label for="expense-splid" class="flex items-center gap-2 cursor-pointer pt-6"><input type="checkbox" id="expense-splid" class="w-5 h-5"><span>Su Splid?</span></label></div>
                        <div class="lg:col-start-4"><button type="submit" class="w-full px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700">Aggiungi</button></div>
                    </form>
                </div>`;

            // 3. CATEGORY CARDS HTML
            const expensesByCategory = budgetData.expenses.reduce((acc, expense) => {
                (acc[expense.category] = acc[expense.category] || []).push(expense);
                return acc;
            }, {});

            const categoryCards = Object.keys(BUDGET_CATEGORIES).map(catKey => {
                const expenses = expensesByCategory[catKey];
                if (!expenses || expenses.length === 0) return '';
                
                const categoryTotal = expenses.reduce((sum, exp) => sum + (parseFloat(exp.amount) || 0), 0);
                
                let categoryHeaderInfo = '';
                if (catKey === 'hotels') {
                    const totalNights = expenses.reduce((sum, exp) => sum + (exp.nights || 0), 0);
                    if (totalNights > 0) {
                        const averagePerNight = categoryTotal / totalNights;
                        categoryHeaderInfo = `<p class="text-sm text-gray-500 mb-4">Totale ${totalNights} notti &bull; Media ${formatCurrency(averagePerNight)}/notte</p>`;
                    }
                }

                const expenseItems = expenses.map(exp => {
                    const nightsInfo = (exp.category === 'hotels' && exp.nights && exp.nights > 0)
                        ? `<p class="text-xs text-gray-500 mt-1">${exp.nights} notti &bull; ${formatCurrency(exp.amount / exp.nights)}/notte</p>`
                        : '';
                    return `
                    <li class="expense-item ${exp.onSplid ? 'on-splid' : ''} ${exp.status} p-3 my-1 rounded-md">
                        <div class="flex justify-between items-start">
                            <div class="flex-grow pr-4">
                                <p>${exp.description}</p>
                                <p class="text-xs text-gray-500">${exp.person}</p>
                                ${nightsInfo}
                            </div>
                            <div class="text-right flex-shrink-0">
                                <p class="font-semibold">${formatCurrency(exp.amount)}</p>
                            </div>
                        </div>
                        <div class="admin-only-flex justify-between items-center mt-2 pt-2 border-t border-slate-200">
                            <div class="flex items-center gap-4">
                                <button data-expense-id="${exp.id}" class="status-toggle px-2 py-1 text-xs rounded font-semibold transition-colors ${exp.status === 'paid' ? 'bg-green-200 text-green-800 hover:bg-green-300' : 'bg-amber-200 text-amber-800 hover:bg-amber-300'}">${exp.status === 'paid' ? 'Pagato' : 'Prenotato'}</button>
                                <label class="flex items-center gap-1.5 cursor-pointer text-xs text-gray-600">
                                    <input type="checkbox" data-expense-id="${exp.id}" class="splid-toggle w-4 h-4 rounded text-indigo-600 focus:ring-indigo-500 focus:ring-offset-0 focus:ring-1" ${exp.onSplid ? 'checked' : ''}>
                                    Su Splid
                                </label>
                            </div>
                            <button data-expense-id="${exp.id}" class="delete-expense-btn text-gray-400 hover:text-red-500" title="Elimina spesa">${TRASH_ICON_SVG}</button>
                        </div>
                        <div class="user-only flex justify-start items-center gap-2 mt-2 pt-2 border-t border-slate-200 text-xs">
                            <span class="font-semibold px-2 py-0.5 rounded-full ${exp.status === 'paid' ? 'bg-green-100 text-green-800' : 'bg-amber-100 text-amber-800'}">${exp.status === 'paid' ? 'Pagato' : 'Prenotato'}</span>
                            ${exp.onSplid ? '<span class="font-semibold px-2 py-0.5 rounded-full bg-slate-200 text-slate-800">Su Splid</span>' : ''}
                        </div>
                    </li>`;
                }).join('');

                return `<div class="card">
                        <h4 class="text-lg font-semibold mb-2">${BUDGET_CATEGORIES[catKey]}</h4>
                        <p class="text-gray-600 mb-2 font-bold text-xl">${formatCurrency(categoryTotal)}</p>
                        ${categoryHeaderInfo}
                        <ul class="text-sm">${expenseItems}</ul>
                    </div>`;
            }).join('');

            // 4. SUMMARY BY PERSON HTML
            const summaryByPerson = budgetData.expenses.reduce((acc, { person, category, amount }) => {
                if (!person) return acc;
                acc[person] = acc[person] || { total: 0, categories: {} };
                acc[person].total += amount;
                acc[person].categories[category] = (acc[person].categories[category] || 0) + amount;
                return acc;
            }, {});

            const summaryByPersonHTML = Object.keys(summaryByPerson).length > 0 ? `
                <div class="card">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">Riepilogo per Persona</h3>
                    ${Object.entries(summaryByPerson).map(([person, data]) => `
                        <div class="mb-4 pb-4 border-b last:border-b-0">
                            <div class="flex justify-between items-baseline">
                                <h4 class="font-semibold text-lg text-indigo-700">${person}</h4>
                                <p class="font-bold text-lg">${formatCurrency(data.total)}</p>
                            </div>
                            <ul class="text-sm mt-2">
                                ${Object.entries(data.categories).map(([cat, catAmount]) => `
                                    <li class="flex justify-between text-gray-600 py-1">
                                        <span>${BUDGET_CATEGORIES[cat]}</span>
                                        <span>${formatCurrency(catAmount)}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    `).join('')}
                </div>` : '';

            // 5. FINAL ASSEMBLY
            container.innerHTML = `
                <div class="card bg-white border-slate-300">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2 md:mb-0">Riepilogo Budget</h2>
                        <div class="flex items-center gap-2">
                            <label for="total-budget-input" class="text-gray-600 font-semibold">Budget Totale:</label>
                            <span class="user-only text-2xl font-bold text-indigo-600">${formatCurrency(totalBudget)}</span>
                            <input type="number" id="total-budget-input" value="${totalBudget}" step="1" class="admin-only font-bold text-indigo-600 text-xl p-1 w-32">
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="progress-bar">
                            <div class="bg-green-500 h-full transition-all duration-500" style="width: ${paidPercentage}%;" title="Pagato: ${formatCurrency(totalPaid)}"></div>
                            <div class="bg-amber-500 h-full transition-all duration-500" style="width: ${bookedPercentage}%;" title="Prenotato: ${formatCurrency(totalBooked)}"></div>
                        </div>
                    </div>
                    <div class="flex flex-wrap justify-between text-sm font-semibold gap-x-4 gap-y-1">
                        <div class="text-gray-600">
                            Speso: <span class="font-bold text-green-600">${formatCurrency(totalPaid)}</span> + <span class="font-bold text-amber-500">${formatCurrency(totalBooked)}</span> = <span class="font-bold text-red-500">${formatCurrency(totalSpent)}</span>
                        </div>
                        <div class="text-gray-600">
                            Rimanente: <span class="font-bold text-blue-600">${formatCurrency(remaining)}</span>
                        </div>
                    </div>
                </div>
                ${adminMode ? adminForm : ''}
                <div id="budget-summary-by-person" class="mt-6">${summaryByPersonHTML}</div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                    ${categoryCards}
                </div>
                <div id="budget-legend" class="card text-sm mt-6"><h4 class="font-semibold mb-2">Legenda</h4><div class="flex flex-wrap gap-x-4 gap-y-2"><div class="flex items-center gap-2"><div class="w-4 h-4 rounded" style="background-color: #f0f9ff; border: 1px solid #bae6fd;"></div><span>Spesa inserita su Splid</span></div><div class="flex items-center gap-2"><div class="w-1 h-4 bg-green-500 rounded"></div><span>Spesa Pagata</span></div><div class="flex items-center gap-2"><div class="w-1 h-4 bg-amber-500 rounded"></div><span>Spesa solo Prenotata</span></div></div></div>`;
        }
        
        function renderUsefulLinks(linksData, adminMode) {
            const container = document.getElementById('links-content');
            const linksList = (linksData || []).map(link => `
                <li class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div><a href="${link.url}" target="_blank" class="font-semibold text-indigo-600 hover:text-indigo-800 hover:underline">${link.title}</a><p class="text-sm text-gray-500">${link.url}</p></div>
                    <button data-link-id="${link.id}" class="delete-link-btn admin-only text-gray-400 hover:text-red-500 p-2" title="Elimina link">${TRASH_ICON_SVG}</button>
                </li>`).join('');
            
            container.innerHTML = `<div class="card bg-white border-slate-300">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Link Utili</h2>
                    ${adminMode ? `<div class="card bg-slate-50 border-indigo-300 mb-6 admin-only-grid"><h3 class="text-xl font-semibold text-gray-700 mb-4">Aggiungi Nuovo Link</h3><form id="add-link-form" class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end"><div class="md:col-span-2"><label for="link-title">Titolo</label><input type="text" id="link-title" required></div><div class="md:col-span-2"><label for="link-url">URL</label><input type="url" id="link-url" required></div><div class="md:col-start-4"><button type="submit" class="w-full px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700">Aggiungi Link</button></div></form></div>` : ''}
                    <ul id="useful-links-list">${linksList.length > 0 ? linksList : '<p class="text-gray-500">Nessun link aggiunto.</p>'}</ul>
                </div>`;
        }

        // --- EVENT LISTENERS & HANDLERS ---
        async function handleImageUpload(event) {
            const input = event.target;
            const idPrefix = input.id.replace('-image-input', '');
            if (input.files[0]) {
                try {
                    const compressedDataUrl = await compressImage(input.files[0]);
                    applyImageChange(idPrefix, compressedDataUrl);
                    saveData();
                } catch (error) { console.error("Errore nella compressione dell'immagine:", error); }
            }
        }
        function applyImageChange(targetId, imageUrl) {
            if (targetId === 'main') currentData.main.image = imageUrl;
            else {
                const index = parseInt(targetId.replace('day', '')) - 1;
                if (currentData.itinerary[index]) currentData.itinerary[index].image = imageUrl;
            }
            renderImage(targetId, imageUrl);
        }
        function openGitHubModal(targetId) { currentImageTargetId = targetId; document.getElementById('github-modal').style.display = 'flex'; }
        function closeGitHubModal() { document.getElementById('github-modal').style.display = 'none'; document.getElementById('github-image-grid').innerHTML = ''; document.getElementById('github-feedback').textContent = ''; currentImageTargetId = null; }
        async function fetchGitHubImages() {
            const user = document.getElementById('github-user').value.trim();
            const repo = document.getElementById('github-repo').value.trim();
            const grid = document.getElementById('github-image-grid');
            const feedback = document.getElementById('github-feedback');
            const fetchBtn = document.getElementById('fetch-github-images-btn');
            if (!user || !repo) { feedback.textContent = 'Per favore, inserisci nome utente e repository.'; feedback.className = 'text-red-500 text-sm mb-2'; return; }
            feedback.textContent = 'Caricamento immagini...'; feedback.className = 'text-blue-500 text-sm mb-2'; grid.innerHTML = ''; fetchBtn.disabled = true;
            try {
                const response = await fetch(`https://api.github.com/repos/${user}/${repo}/contents`);
                if (!response.ok) throw new Error(`Errore: ${response.statusText}`);
                const data = await response.json();
                const imageFiles = data.filter(file => /\.(jpe?g|png|gif|webp)$/i.test(file.name));
                if (imageFiles.length === 0) { feedback.textContent = 'Nessuna immagine trovata nel repository.'; feedback.className = 'text-yellow-500 text-sm mb-2'; return; }
                feedback.textContent = `Trovate ${imageFiles.length} immagini. Clicca per selezionare.`; feedback.className = 'text-green-600 text-sm mb-2';
                imageFiles.forEach(file => {
                    const imgContainer = document.createElement('div');
                    imgContainer.className = 'cursor-pointer border-2 border-transparent hover:border-indigo-500 rounded-lg overflow-hidden';
                    imgContainer.innerHTML = `<img src="${file.download_url}" alt="${file.name}" class="w-full h-full object-cover">`;
                    imgContainer.addEventListener('click', () => { applyImageChange(currentImageTargetId, file.download_url); saveData(); closeGitHubModal(); });
                    grid.appendChild(imgContainer);
                });
            } catch (error) { console.error('Errore API GitHub:', error); feedback.textContent = `Errore nel caricamento: ${error.message}`; feedback.className = 'text-red-500 text-sm mb-2'; } 
            finally { fetchBtn.disabled = false; }
        }
        
        function handleDateUpdate() {
            const startDate = document.getElementById('start-date-input').value;
            const endDate = document.getElementById('end-date-input').value;
            if (!startDate || !endDate) { alert("Per favore, seleziona sia la data di inizio che quella di fine."); return; }
            const start = new Date(startDate); const end = new Date(endDate);
            if (start > end) { alert("La data di fine non può essere precedente alla data di inizio."); return; }
            const newItinerary = [];
            for (let d = start; d <= end; d.setDate(d.getDate() + 1)) {
                const dateString = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate())).toISOString().split('T')[0];
                const existingDay = currentData.itinerary.find(day => day.date === dateString) || { date: dateString, location: "Da definire", isFlight: false, isCruise: false, accommodation: "", activities: "", image: "" };
                newItinerary.push(existingDay);
            }
            currentData.itinerary = newItinerary;
            createDetailedItinerary(currentData.itinerary, true);
            updateCalendar(currentData.itinerary);
            setupDynamicEventListeners();
            saveData();
        }

        function addFlight() { currentData.flights.push({ idPrefix: `flight_${Date.now()}`, title: "Nuovo Volo", depAirport: "", arrAirport: "", depTime: "", arrTime: "", depTz: 1, arrTz: 1 }); renderApp(currentData, isAdminMode); }
        function removeFlight(idPrefix) { if (confirm("Sei sicuro di voler rimuovere questo volo?")) { currentData.flights = currentData.flights.filter(f => f.idPrefix !== idPrefix); renderApp(currentData, isAdminMode); saveData(); } }
        function addTour() { currentData.tours.push({ id: Date.now(), title: "Nuovo Tour", depTime: "", arrTime: "", type: "boat", description: "" }); renderApp(currentData, isAdminMode); }
        function removeTour(tourId) { if (confirm("Sei sicuro di voler rimuovere questo tour?")) { currentData.tours = currentData.tours.filter(t => t.id !== tourId); renderApp(currentData, isAdminMode); saveData(); } }
        
        function updateFlightSummaryTable() {
            const tableBody = document.querySelector('#flights-summary-table tbody');
            if (!tableBody) return;
            const flightData = buildDataObjectFromDOM().flights;
            tableBody.innerHTML = flightData.map(flight => `<tr class="border-b last:border-b-0"><td class="py-2 pr-4 font-medium">${flight.title}</td><td class="py-2 pl-4 text-right">${calculateDurationString(flight.depTime, flight.arrTime, flight.depTz, flight.arrTz)}</td></tr>`).join('');
        }

        function setupStaticEventListeners() {
            document.getElementById('reset-btn').addEventListener('click', resetItinerary);
            document.getElementById('pdf-btn').addEventListener('click', () => document.getElementById('pdf-quality-modal').classList.remove('hidden'));
            document.getElementById('export-html-btn').addEventListener('click', exportHTML);
            document.getElementById('apply-dates-btn').addEventListener('click', handleDateUpdate);
            
            const allBtns = document.querySelectorAll('.tab-button');
            const allContents = document.querySelectorAll('#main-content > section');
            allBtns.forEach(btn => btn.addEventListener('click', () => {
                const targetId = btn.id.replace('tab-btn-', '') + '-content';
                allContents.forEach(content => content.classList.toggle('hidden', content.id !== targetId));
                allBtns.forEach(b => b.classList.toggle('active', b === btn));
            }));
            
            document.getElementById('fetch-github-images-btn').addEventListener('click', fetchGitHubImages);
            document.getElementById('close-github-modal-btn').addEventListener('click', closeGitHubModal);
            document.getElementById('pdf-quality-cancel-btn').addEventListener('click', () => document.getElementById('pdf-quality-modal').classList.add('hidden'));
            document.querySelectorAll('.pdf-quality-btn').forEach(btn => btn.addEventListener('click', () => {
                document.getElementById('pdf-quality-modal').classList.add('hidden');
                saveAsPDF(PDF_QUALITY_PRESETS[btn.dataset.quality]);
            }));
        }
        function setupDynamicEventListeners() {
            document.body.removeEventListener('input', handleDynamicInput);
            document.body.removeEventListener('change', handleDynamicChange);
            document.body.removeEventListener('submit', handleDynamicSubmit);
            document.body.removeEventListener('click', eventDelegationHandler);
            document.body.addEventListener('input', handleDynamicInput);
            document.body.addEventListener('change', handleDynamicChange);
            document.body.addEventListener('submit', handleDynamicSubmit);
            document.body.addEventListener('click', eventDelegationHandler);
        }

        function handleDynamicInput(e) {
            if (e.target.matches('textarea')) autoGrowTextarea(e.target);
            if (e.target.matches('input[id$="-airport"], input[id$="-accommodation"]')) updateGmapsLink(e.target);
            if (e.target.id === 'total-budget-input') { currentData.budget.total = parseFloat(e.target.value) || 0; renderBudget(currentData.budget, isAdminMode); saveData(); }
            if (e.target.closest('.flight-card')) updateFlightSummaryTable();
            if (e.target.closest('.tour-card')) {
                const card = e.target.closest('.tour-card');
                const tourId = card.dataset.id;
                const durationEl = document.getElementById(`tour-${tourId}-duration`);
                if (durationEl) {
                    const depTime = document.getElementById(`tour-${tourId}-dep-time`).value;
                    const arrTime = document.getElementById(`tour-${tourId}-arr-time`).value;
                    durationEl.textContent = calculateDurationString(depTime, arrTime, null, null);
                }
            }
        }

        function handleDynamicChange(e) {
            if (e.target.matches('input[type="file"]')) handleImageUpload(e);
            if (e.target.matches('input[id$="-flight-check"], input[id$="-cruise-check"]')) { saveData(); updateCalendar(currentData.itinerary); }
            if (e.target.closest('.flight-card, .tour-card')) { if (e.target.closest('.flight-card')) updateFlightSummaryTable(); saveData(); }
            if (e.target.matches('.splid-toggle')) {
                const expenseId = parseInt(e.target.dataset.expenseId);
                const expense = currentData.budget.expenses.find(exp => exp.id === expenseId);
                if (expense) {
                    expense.onSplid = e.target.checked;
                    renderBudget(currentData.budget, isAdminMode);
                    saveData();
                }
            }
            if (e.target.id === 'expense-category') {
                const nightsContainer = document.getElementById('expense-nights-container');
                if (nightsContainer) {
                    if (e.target.value === 'hotels') {
                        nightsContainer.classList.remove('hidden');
                    } else {
                        nightsContainer.classList.add('hidden');
                    }
                }
            }
        }

        function handleDynamicSubmit(e) {
            if (e.target.id === 'add-expense-form') {
                e.preventDefault();
                const newExpense = {
                    id: Date.now(),
                    description: document.getElementById('expense-desc').value,
                    amount: parseFloat(document.getElementById('expense-amount').value),
                    category: document.getElementById('expense-category').value,
                    person: document.getElementById('expense-person').value.trim(),
                    status: document.getElementById('expense-status').value,
                    onSplid: document.getElementById('expense-splid').checked
                };
                if (newExpense.category === 'hotels') {
                    const nightsInput = document.getElementById('expense-nights');
                    newExpense.nights = nightsInput && nightsInput.value ? parseInt(nightsInput.value, 10) : 0;
                }
                currentData.budget.expenses.push(newExpense);
                renderBudget(currentData.budget, isAdminMode);
                saveData();
                e.target.reset();
                document.getElementById('expense-nights-container')?.classList.add('hidden');
            }
            if (e.target.id === 'add-link-form') {
                e.preventDefault();
                currentData.usefulLinks.push({ id: Date.now(), title: document.getElementById('link-title').value, url: document.getElementById('link-url').value });
                renderUsefulLinks(currentData.usefulLinks, isAdminMode);
                saveData();
                e.target.reset();
            }
        }

        function eventDelegationHandler(e) {
            const githubBtn = e.target.closest('.github-open-btn');
            if (githubBtn) openGitHubModal(githubBtn.dataset.targetId);

            const removeBtn = e.target.closest('.remove-image-btn');
            if (removeBtn) { applyImageChange(removeBtn.dataset.targetId, ''); saveData(); }

            const tripDay = e.target.closest('.trip-day');
            if(tripDay && tripDay.dataset.date) {
                document.getElementById('tab-btn-itinerary').click();
                setTimeout(() => {
                    const targetCard = document.querySelector(`.day-card-wrapper[data-date="${tripDay.dataset.date}"]`);
                    if(targetCard) targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 100);
            }
            
            const statusToggle = e.target.closest('.status-toggle');
            if (statusToggle) {
                const expenseId = parseInt(statusToggle.dataset.expenseId);
                const expense = currentData.budget.expenses.find(exp => exp.id === expenseId);
                if (expense) {
                    expense.status = expense.status === 'paid' ? 'booked' : 'paid';
                    renderBudget(currentData.budget, isAdminMode);
                    saveData();
                }
            }

            const deleteExpenseBtn = e.target.closest('.delete-expense-btn');
            if (deleteExpenseBtn) {
                const expenseId = parseInt(deleteExpenseBtn.dataset.expenseId);
                currentData.budget.expenses = currentData.budget.expenses.filter(exp => exp.id !== expenseId);
                renderBudget(currentData.budget, isAdminMode);
                saveData();
            }

            const deleteLinkBtn = e.target.closest('.delete-link-btn');
            if (deleteLinkBtn) {
                const linkId = parseInt(deleteLinkBtn.dataset.linkId);
                currentData.usefulLinks = currentData.usefulLinks.filter(link => link.id !== linkId);
                renderUsefulLinks(currentData.usefulLinks, isAdminMode);
                saveData();
            }

            if (e.target.closest('#add-flight-btn')) addFlight();
            const deleteFlightBtn = e.target.closest('.delete-flight-btn');
            if (deleteFlightBtn) removeFlight(deleteFlightBtn.dataset.flightId);
            
            if (e.target.closest('#add-tour-btn')) addTour();
            const deleteTourBtn = e.target.closest('.delete-tour-btn');
            if (deleteTourBtn) removeTour(parseInt(deleteTourBtn.dataset.tourId));
        }
        
        // --- INITIALIZATION & STARTUP LOGIC ---
        function handleSiteLogin(event) {
            event.preventDefault();
            const passwordInput = document.getElementById('site-access-password-input');
            if (passwordInput.value === SITE_ACCESS_PASSWORD) {
                sessionStorage.setItem('siteAccessGranted', 'true');
                document.getElementById('site-access-modal').classList.add('hidden');
                document.body.classList.remove('content-hidden');
                initializeApp();
            } else {
                document.getElementById('site-access-password-error').classList.remove('hidden');
                passwordInput.value = '';
                passwordInput.focus();
            }
        }

        function handleAdminLogin(event) {
            event.preventDefault();
            const passwordInput = document.getElementById('admin-password-input');
            if (passwordInput.value === ADMIN_PASSWORD) {
                sessionStorage.setItem('isAdmin', 'true');
                document.getElementById('admin-modal').classList.add('hidden');
                document.getElementById('admin-password-error').classList.add('hidden');
                passwordInput.value = '';
                renderApp(currentData, true);
            } else {
                document.getElementById('admin-password-error').classList.remove('hidden');
                passwordInput.value = '';
                passwordInput.focus();
            }
        }
        function handleAdminLogout() { saveData(); sessionStorage.removeItem('isAdmin'); renderApp(currentData, false); }
        
        function initializeApp() {
            isAdminMode = sessionStorage.getItem('isAdmin') === 'true';
            currentData = loadData();
            if(!currentData.usefulLinks) currentData.usefulLinks = [];
            if(!currentData.tours) currentData.tours = [];
            renderApp(currentData, isAdminMode);
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('site-access-form').addEventListener('submit', handleSiteLogin);
            document.getElementById('admin-login-btn').addEventListener('click', () => { document.getElementById('admin-modal').classList.remove('hidden'); document.getElementById('admin-password-input').focus(); });
            document.getElementById('admin-logout-btn').addEventListener('click', handleAdminLogout);
            document.getElementById('admin-form').addEventListener('submit', handleAdminLogin);
            document.getElementById('admin-cancel-btn').addEventListener('click', () => document.getElementById('admin-modal').classList.add('hidden'));
            
            setupStaticEventListeners();

            if (sessionStorage.getItem('siteAccessGranted') === 'true') {
                document.getElementById('site-access-modal').classList.add('hidden');
                document.body.classList.remove('content-hidden');
                initializeApp();
            } else {
                document.getElementById('site-access-password-input').focus();
            }
        });
    </script>


</body></html>